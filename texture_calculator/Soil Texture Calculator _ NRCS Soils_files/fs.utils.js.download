/***************************************
* @preserve
* ForeSee Web SDK: Utils Library
* Built December 21, 17 13:13:26
* Code version: 19.5.2
* Template version: 19.5.2
***************************************/
_fsDefine(["require","fs"],function(t,e){function i(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function r(t,e){return t<<e|t>>>32-e}function n(t,e,n,a,s,o){return i(r(i(i(e,t),i(a,o)),s),n)}function a(t,e,i,r,a,s,o){return n(e&i|~e&r,t,e,a,s,o)}function o(t,e,i,r,a,s,o){return n(e&r|i&~r,t,e,a,s,o)}function f(t,e,i,r,a,s,o){return n(e^i^r,t,e,a,s,o)}function h(t,e,i,r,a,s,o){return n(i^(e|~r),t,e,a,s,o)}function u(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var r,n,s,u,l,c=1732584193,d=-271733879,p=-1732584194,g=271733878;for(r=0;r<t.length;r+=16)n=c,s=d,u=p,l=g,c=a(c,d,p,g,t[r],7,-680876936),g=a(g,c,d,p,t[r+1],12,-389564586),p=a(p,g,c,d,t[r+2],17,606105819),d=a(d,p,g,c,t[r+3],22,-1044525330),c=a(c,d,p,g,t[r+4],7,-176418897),g=a(g,c,d,p,t[r+5],12,1200080426),p=a(p,g,c,d,t[r+6],17,-1473231341),d=a(d,p,g,c,t[r+7],22,-45705983),c=a(c,d,p,g,t[r+8],7,1770035416),g=a(g,c,d,p,t[r+9],12,-1958414417),p=a(p,g,c,d,t[r+10],17,-42063),d=a(d,p,g,c,t[r+11],22,-1990404162),c=a(c,d,p,g,t[r+12],7,1804603682),g=a(g,c,d,p,t[r+13],12,-40341101),p=a(p,g,c,d,t[r+14],17,-1502002290),d=a(d,p,g,c,t[r+15],22,1236535329),c=o(c,d,p,g,t[r+1],5,-165796510),g=o(g,c,d,p,t[r+6],9,-1069501632),p=o(p,g,c,d,t[r+11],14,643717713),d=o(d,p,g,c,t[r],20,-373897302),c=o(c,d,p,g,t[r+5],5,-701558691),g=o(g,c,d,p,t[r+10],9,38016083),p=o(p,g,c,d,t[r+15],14,-660478335),d=o(d,p,g,c,t[r+4],20,-405537848),c=o(c,d,p,g,t[r+9],5,568446438),g=o(g,c,d,p,t[r+14],9,-1019803690),p=o(p,g,c,d,t[r+3],14,-187363961),d=o(d,p,g,c,t[r+8],20,1163531501),c=o(c,d,p,g,t[r+13],5,-1444681467),g=o(g,c,d,p,t[r+2],9,-51403784),p=o(p,g,c,d,t[r+7],14,1735328473),d=o(d,p,g,c,t[r+12],20,-1926607734),c=f(c,d,p,g,t[r+5],4,-378558),g=f(g,c,d,p,t[r+8],11,-2022574463),p=f(p,g,c,d,t[r+11],16,1839030562),d=f(d,p,g,c,t[r+14],23,-35309556),c=f(c,d,p,g,t[r+1],4,-1530992060),g=f(g,c,d,p,t[r+4],11,1272893353),p=f(p,g,c,d,t[r+7],16,-155497632),d=f(d,p,g,c,t[r+10],23,-1094730640),c=f(c,d,p,g,t[r+13],4,681279174),g=f(g,c,d,p,t[r],11,-358537222),p=f(p,g,c,d,t[r+3],16,-722521979),d=f(d,p,g,c,t[r+6],23,76029189),c=f(c,d,p,g,t[r+9],4,-640364487),g=f(g,c,d,p,t[r+12],11,-421815835),p=f(p,g,c,d,t[r+15],16,530742520),d=f(d,p,g,c,t[r+2],23,-995338651),c=h(c,d,p,g,t[r],6,-198630844),g=h(g,c,d,p,t[r+7],10,1126891415),p=h(p,g,c,d,t[r+14],15,-1416354905),d=h(d,p,g,c,t[r+5],21,-57434055),c=h(c,d,p,g,t[r+12],6,1700485571),g=h(g,c,d,p,t[r+3],10,-1894986606),p=h(p,g,c,d,t[r+10],15,-1051523),d=h(d,p,g,c,t[r+1],21,-2054922799),c=h(c,d,p,g,t[r+8],6,1873313359),g=h(g,c,d,p,t[r+15],10,-30611744),p=h(p,g,c,d,t[r+6],15,-1560198380),d=h(d,p,g,c,t[r+13],21,1309151649),c=h(c,d,p,g,t[r+4],6,-145523070),g=h(g,c,d,p,t[r+11],10,-1120210379),p=h(p,g,c,d,t[r+2],15,718787259),d=h(d,p,g,c,t[r+9],21,-343485551),c=i(c,n),d=i(d,s),p=i(p,u),g=i(g,l);return[c,d,p,g]}function c(t){var e,i="";for(e=0;e<32*t.length;e+=8)i+=String.fromCharCode(t[e>>5]>>>e%32&255);return i}function d(t){var e,i=[];for(i[(t.length>>2)-1]=void 0,e=0;e<i.length;e+=1)i[e]=0;for(e=0;e<8*t.length;e+=8)i[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return i}function p(t){return c(u(d(t),8*t.length))}function g(t,e){var i,r,n=d(t),a=[],s=[];for(a[15]=s[15]=void 0,n.length>16&&(n=u(n,8*t.length)),i=0;i<16;i+=1)a[i]=909522486^n[i],s[i]=1549556828^n[i];return r=u(a.concat(d(e)),512+8*e.length),c(u(s.concat(r),640))}function y(t){var e,i,r="0123456789abcdef",n="";for(i=0;i<t.length;i+=1)e=t.charCodeAt(i),n+=r.charAt(e>>>4&15)+r.charAt(15&e);return n}function b(t){return decodeURIComponent(e.enc(t))}function w(t){return p(b(t))}function v(t){return y(w(t))}function m(t,e){return g(b(t),b(e))}function S(t,e){return y(m(t,e))}var x="undefined"!=typeof Uint8Array,_=window,k={APPID:{TRIGGER:"funcxm",FEEDBACK:"funfbk",REPLAY:"funrep"}};e&&e.home&&e.home,k.md5=function(t,e,i){return e?i?m(e,t):S(e,t):i?w(t):v(t)},k.escapeRegExp=function(t){return(t||"").toString().replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},k.trim=function(t){return(t||"").toString().replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")},k.stripHTML=function(t){return(t||"").replace(/(<([^>]+)>)/gi,"")},k.unlink=function(t){var i,r;if(e.isPlainObject(t)){i={};for(var n in t)i[n]=k.unlink(t[n])}else if(Array.isArray(t))for(i=[],r=0,l=t.length;r<l;r++)i[r]=k.unlink(t[r]);else i=t;return i};var B={};k.preventDefault=function(t){t&&t.preventDefault?t.preventDefault():window.event&&window.event.returnValue?window.eventReturnValue=!1:t.returnValue=!1};var T=[],I=function(t){var e="default";if(t.indexOf(":")>-1){var i=t.split(":");e=i[0],t=i[1]}return B[e]||(B[e]={}),B[e][t]||(B[e][t]=[]),{ns:e,en:t}};k.Bind=function(t,e,i,r){if(t&&e){var n=I(e);if(B[n.ns][n.en].push({elem:t,cb:i,ub:!!r}),e.indexOf("unload")>-1)return void T.push(i);"propertychange"!=n.en&&t.addEventListener?t.addEventListener(n.en,i,!r):t.attachEvent&&t.attachEvent("on"+n.en,i)}},k.BindOnce=function(t,e,i){if(t&&e){var r=I(e);if(t["_acsEvent"+r.en])return;t["_acsEvent"+r.en]=!0,k.Bind(t,e,i)}};var A=function(t,e,i,r){e&&(e.parentNode||e.window||9==e.nodeType)&&("propertychange"!=t&&e.removeEventListener?e.removeEventListener(t,i,!r):e.detachEvent&&e.detachEvent("on"+t,i))};k.Unbind=function(t,e,i,r){var n,a,s,o;if(e&&e.indexOf("unload")>-1){for(o=0;o<T.length;o++)if(T[o]==i){T.splice(o,1);break}}else if(0===arguments.length)for(var f in B)k.Unbind(f+":*"),delete B[f];else if("string"==typeof t)if(n=I(t),"default"==n.ns){for(var h in B)if(B.hasOwnProperty(h)){a=B[h];for(var u in a)if(a.hasOwnProperty(u)&&(u==n.en||"*"==n.en))for(o=0;o<a[u].length;o++)s=a[u][o],A(u,s.elem,s.cb,s.ub),a[u].splice(o--,1)}}else{a=B[n.ns];for(var l in a)if(a.hasOwnProperty(l)&&(l==n.en||"*"==n.en))for(o=0;o<a[l].length;o++)s=a[l][o],A(l,s.elem,s.cb,s.ub),a[l].splice(o--,1)}else if(t&&!e){for(var c in B)if(B.hasOwnProperty(c)){a=B[c];for(var d in a)if(a.hasOwnProperty(d))for(o=0;o<a[d].length;o++)s=a[d][o],s.elem===t&&(A(d,s.elem,s.cb,s.ub),a[d].splice(o--,1))}}else if(t&&e)if(n=I(e),"default"==n.ns){for(var p in B)if(B.hasOwnProperty(p)){a=B[p];for(var g in a)if(a.hasOwnProperty(g)&&(g==n.en||"*"==n.en))for(o=0;o<a[g].length;o++)s=a[g][o],s.elem===t&&(A(g,s.elem,i||s.cb,s.ub),a[g].splice(o--,1))}}else{n=I(e),a=B[n.ns];for(var y in a)if(a.hasOwnProperty(y)&&(y==n.en||"*"==n.en))for(o=0;o<a[y].length;o++)s=a[y][o],s.elem===t&&(A(y,s.elem,i||s.cb,s.ub),a[y].splice(o--,1))}};var E=!1;if(k.preventUnloadFlag=!1,k._preventUnloadFor=function(t){E=!0,setTimeout(function(){E=!1},t)},k.HandleUnload=function(){if(!E&&!k.preventUnloadFlag){for(var t=T.length-1;t>=0;t--)try{T[t].call()}catch(t){}e.dispose(T),k.Unbind()}},document.addEventListener?(window.addEventListener("beforeunload",k.HandleUnload,!0),window.addEventListener("pagehide",k.HandleUnload,!0),document.addEventListener("unload",k.HandleUnload,!0)):document.attachEvent&&window.attachEvent("onunload",k.HandleUnload),k.getKeyCode=function(t){return t&&void 0!==t.key?t.key.toLowerCase():{32:" ",13:"enter",37:"arrowleft",39:"arrowright"}[t.keyCode>0?t.keyCode:t.which]},k.FSEvent=function(){this.id="_"+Math.round(99999*Math.random()),this.subscriptions=[],this.didFire=!1},k.FSEvent.prototype.subscribe=function(t,e,i){return this.subscriptions.push({once:!!e,cb:t}),i&&this.didFire&&(this.prevArgs?this.fire.apply(this,this.prevArgs):this.fire()),{unsubscribe:function(t,e){return function(){t.unsubscribe(e)}}(this,t)}},k.FSEvent.prototype.unsubscribe=function(t){for(var e=0;e<this.subscriptions.length;e++)this.subscriptions[e].cb==t&&(this.subscriptions.splice(e,1),e--)},k.FSEvent.prototype.unsubscribeAll=function(){this.subscriptions=[]},k.FSEvent.prototype.fire=function(){this.didFire=!0,this.prevArgs=arguments;for(var t=0;t<this.subscriptions.length;t++){var e=this.subscriptions[t];e.once&&this.subscriptions.splice(t--,1),e.cb.apply(this,arguments)}},k.pageNavEvent=new k.FSEvent,history&&history.pushState){window.addEventListener("popstate",function(t){E||k.pageNavEvent.fire()});var R=history.pushState;history.pushState=function(){R.apply(history,arguments),E||k.pageNavEvent.fire()}}k.FSEvent.prototype.chain=function(t,i,r){t&&t.constructor===k.FSEvent&&t.subscribe(e.proxy(function(){this.fire.apply(this,arguments)},this),i,r)};var C=function(t){this.browser=t,this.sig="not detected",this.ready=new k.FSEvent,this._detect()};C.prototype._detect=function(){var t,i=e.proxy(function(t){this.sig=t,this.ready.fire(t)},this),r=[],n=navigator,a=this.browser;if(_!=_.top){var s=location.search.match(/uid=([\d\w]*)/i);s&&s[1]&&(t=s[1])}t&&"not detected"!=t||!a.supportsLocalStorage||(t=localStorage.getItem("_fsPRINT")),t||(r=k.trim(navigator.userAgent.replace(/[0-9\.\/\\\(\);_\-]*/gi,"")).split(" "),r.push(n.language||""),r.push(n.hardwareConcurrency||""),r.push(n.platform||""),r.push(n.vendor||""),r.push(n.appName||""),r.push(n.maxTouchPoints||""),r.push(n.doNotTrack||"false"),r.push(a.os.name||"false"),r.push(a.os.version||"false"),r.push(this._getCanvasPrint()),t=k.md5(r.join("")),this.sig=t,a.supportsLocalStorage&&localStorage.setItem("_fsPRINT",t)),e.nextTick(function(){i(t)})},C.prototype._getCanvasPrint=function(){try{var t=document.createElement("canvas"),e=t.getContext("2d"),i="ForeSee,CloudUser <canvas> 1.0";return t.width=250,t.height=30,e.textBaseline="top",e.font="14px 'Arial'",e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText(i,2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText(i,4,17),t.toDataURL()}catch(t){return"nocanvas"}},k.Fingerprint=C;var D=function(t){this.browser=t,this.ready=new k.FSEvent,this.ajax=new k.AjaxTransport,e.nextTick(e.proxy(function(){this.ready.fire()},this))};D.prototype.send=function(t){this.ready.subscribe(e.proxy(function(){if(this.ajax)this.ajax.send(t);else{var i=e.ext({method:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(){},failure:function(){}},t);this.fstg.ajax(i.method,i.url,i.data,function(t){return function(e,i){e?t.success(i):t.failure(i)}}(i),!e.isDefined(t.skipEncode)||!!t.skipEncode,i.contentType)}},this),!0,!0)},D.prototype.dispose=function(){this.ajax&&this.ajax.dispose()},k.CORS=D,k.getSize=function(t){var e=0,i=0,r=t.document,n=r.documentElement;return"number"==typeof t.innerWidth?(e=t.innerWidth,i=t.innerHeight):n&&(n.clientWidth||n.clientHeight)?(e=n.clientWidth,i=n.clientHeight):r.body&&(r.body.clientWidth||r.body.clientHeight)&&(e=r.body.clientWidth,i=r.body.clientHeight),{w:e,h:i}},k.getScroll=function(t){var e=0,i=0,r=t.document,n=r.documentElement;return"number"==typeof t.pageYOffset?(i=t.pageYOffset,e=t.pageXOffset):r.body&&(r.body.scrollLeft||r.body.scrollTop)?(i=r.body.scrollTop,e=r.body.scrollLeft):n&&(n.scrollLeft||n.scrollTop)&&(i=n.scrollTop,e=n.scrollLeft),{x:e,y:i}},k.setScroll=function(t,e,i){t.scrollTo(e,i)},k.getScreenResolution=function(){var t=window.screen;return e.isDefined(t)&&e.isDefined(t.width)&&"number"==typeof t.width?{w:t.width,h:t.height}:{w:0,h:0}},k.getFrameWindow=function(t){var e;return t&&t.contentWindow?e=t.contentWindow:t&&t.contentDocument&&t.contentDocument.defaultView&&(e=t.contentDocument.defaultView),e&&e!=e.top?e:null},k.INT={},k.AjaxTransport=function(t){var i={method:"POST",data:{},contentType:"application/x-www-form-urlencoded",success:function(){},failure:function(){}};this.options=e.ext(i,t)},k.AjaxTransport.prototype.send=function(t){var i=e.ext({},this.options,t||{});window.XDomainRequest&&-1==window.navigator.userAgent.indexOf("MSIE 10")?this._sendViaXDR(i):window.XMLHttpRequest&&this._sendViaXHR(i),i=null},k.AjaxTransport.prototype.dispose=function(){e.dispose(this.options)},k.AjaxTransport.isSupported=function(){return!0},k.AjaxTransport.initialize=function(t){t.call(k.AjaxTransport)},k.AjaxTransport.prototype._sendViaXHR=function(t){var i=new window.XMLHttpRequest,r=t.contentType?e.toLowerCase(t.contentType).indexOf("json")>-1?"application/json; charset=utf-8":t.contentType:"application/x-www-form-urlencoded",n=e.toLowerCase(r).indexOf("json")>-1,a=n?"GET"==t.method?e.enc(JSON.stringify(t.data)):JSON.stringify(t.data):e.isDefined(t.skipEncode)&&!0===t.skipEncode?t.data:e.toQueryString(t.data),s=t.url;t.failure=t.failure||function(){},"GET"==t.method&&a&&a.length>0&&(s.indexOf("?")>-1?s+="&":s+="?",s+=a);try{i.open(t.method,s,!0)}catch(t){return}if(i.setRequestHeader("Accept","*/*"),i.setRequestHeader("Content-Type",r),e.isObject(t.headers))for(var o in t.headers)e.isDefined(o)&&e.isDefined(t.headers[o])&&i.setRequestHeader(o,t.headers[o]);i.timeout=t.timeout||0,i.onreadystatechange=function(t,e){return function(){4==e.readyState&&200==e.status?t.success&&t.success.apply(t,[e.responseText]):4==e.readyState&&200!=e.status&&t.failure&&t.failure.apply(t,[e.responseText])}}(t,i),i.send(a)},k.AjaxTransport.prototype._sendViaXDR=function(t){var i=e.isDefined(t.skipEncode)&&!0===t.skipEncode&&"GET"!==t.method.toUpperCase()?t.data:e.toQueryString(t.data,null,!1),r=t.url;t.failure=t.failure||function(){},"GET"==t.method&&i&&i.length>0&&(i=i.replace("?",""),r.indexOf("?")>-1?r+="&":r+="?",r+=i);var n=new window.XDomainRequest;n.onerror=t.failure||function(){},n.ontimeout=t.failure||function(){},n.onprogress=function(){},n.onload=function(t,e){return function(){e.success(t.responseText),t=null,e=null}}(n,t),n.timeout=6e4;try{n.open(t.method,r)}catch(e){return void(t.failure&&t.failure(e))}e.nextTick(function(){i?(e.isString(i)||(i=JSON.stringify(i)),n.send(i)):n.send()})},k.testSameDomain=function(t,i){var r=document.createElement("a");r.href=location.href;var n=r.hostname,a=r.protocol;r.href=t;var s=r.hostname||n,o=0===r.protocol.indexOf("http")?r.protocol:a;r.href=i;var f=r.hostname||n,h=0===r.protocol.indexOf("http")?r.protocol:a;return e.toLowerCase(s)==e.toLowerCase(f)&&e.toLowerCase(o)==e.toLowerCase(h)},k.addParameterToURL=function(t,e){return t+=(t.split("?")[1]?"&":"?")+e},k.hash=function(t){var e=t.split("_");return 3*e[0]+1357+""+(9*e[1]+58)},k.hashCode=function(t){var e,i=0,r="";if(0===t.length)return i;for(e=0;e<t.length;e++)r=t.charCodeAt(e),i=(i<<5)-i+r,i&=i;return i},k.testAgainstSearch=function(t,i){if(null===t||"boolean"==typeof t||"boolean"==typeof i)return!1;if("."===t)return!0;if(t instanceof RegExp)return t.test(i);if(-1==t.indexOf("*")&&-1==t.indexOf("//")&&""!==t.trim())return i.indexOf(t)>-1;var r,n,a;if(t=e.toLowerCase(t.replace(/^\s+|\s+$/g,"").replace(/[\*]{2,}/g,"*")),i=e.toLowerCase(i),"*"==t)return!0;for(n=[];t.indexOf("*")>-1;)t.indexOf("*")>0&&n.push(t.substr(0,t.indexOf("*"))),n.push("*"),t=t.substr(t.indexOf("*")+1);for(t.length>0&&n.push(t),r=0!==n.length,a=0;a<n.length;a++)if("*"==(t=n[a])){if(n.length>a+1){if(a++,-1==i.indexOf(n[a])){r=!1;break}i=i.substr(i.indexOf(n[a])+n[a].length)}if(a==n.length-1&&"*"!==n[a]&&i!=n[a]&&i!=n[a]+"/"&&n[a]!=i+"/"&&i.length>0&&"/"!=i){r=!1;break}}else{if(i.substr(0,t.length)!=t&&i!=t+"/"&&t!=i+"/"){r=!1;break}if(i=i.substr(t.length),a==n.length-1&&i.length>0&&"/"!=i){r=!1;break}}return!!r},k.getRootDomain=function(t){t=e.toLowerCase(t||document.domain).replace("https://","").replace("http://","");for(var i,r=["/","?",":"],n=r.length,a=0;a<n;a++)(i=t.indexOf(r[a]))>-1&&(t=t.substr(0,i));if(t.indexOf("localhost")>-1||0===t.replace(/[0-9\.]/g,"").length)return t;var s=t.split("."),o=s.length;return o>2&&(function(t){return["com","co","org","gov","edu","net"].indexOf(t)>-1}(s[o-2])||function(t){return t.indexOf("qc.ca")>-1}(t))?s[o-3]+"."+s[o-2]+"."+s[o-1]:o>1?s[o-2]+"."+s[o-1]:t},k.storageTypes={CK:"COOKIE",MC:"MICROCOOKIE",CL:"COOKIELESS",DS:"DOMSTORAGE"},k.persistDataType={GENERAL:"GENERAL",TRACKER:"TRACKER"};var O=function(t,i){var r=k.storageTypes,n=this.pers=e.config.storage.toUpperCase(),a=new Date,s={path:"/",domain:this.selectCookieDomain(e.config.cookieDomain,window.location.toString()),secure:!1,encode:!0,expires:new Date(a.getFullYear()+2,a.getMonth(),a.getDate()).toUTCString()};this._general={data:{when:k.now(),keys:{}},isStale:!1,lock:null,cThreshold:2e3,lastMaint:k.now(),lastSave:k.now(),lastSync:k.now(),isSyncing:!1},this._tracker={data:{when:k.now(),keys:{}},isStale:!1,lock:null,cThreshold:300,lastMaint:k.now(),lastSave:k.now(),lastSync:k.now(),isSyncing:!1},e.ext(this,{_storageKey:"_4c_",_microStorageKey:"_4c_mc_",isReady:!1,_healthyServices:["brain"],defaultExpire:7776e6,ready:new k.FSEvent,onCommit:new k.FSEvent,onSync:new k.FSEvent,_readyState:new k.FSEvent,maxExpire:-1,timeOffset:0,_keyEvents:{},_updateTimeout:6e4,_serverFails:0,brainOnlyComms:this.pers==k.storageTypes.CK||this.pers==k.storageTypes.DS}),this.browser=t,t.ready.subscribe(function(){t.supportsLocalStorage||n!=r.DS?t.isMobile&&n==r.CL&&(n=r.MC):n=r.CK,this.cors=new k.CORS(t),n==r.CK?this.ckie=new k.Cookie(s):n==r.MC?(this.ckie=new k.Cookie(s),this.uid=i||this.ckie.get(this._microStorageKey),this.uid&&(this.uid.length>64||this.uid.indexOf("{")>-1)&&(this.uid=k.generateGUID(),this.ckie.set(this._microStorageKey,this.uid)),this.uid||(this.uid=k.generateGUID(),this.ckie.set(this._microStorageKey,this.uid))):n==r.CL?(this.ckie=new k.Cookie,this.uid=i||t.fp):n==r.DS&&(this._general.cThreshold=500),this._sync(!1,function(){this.get("rid")?this.uid=this.get("rid"):(this.uid=this.uid||k.generateGUID(),this.set("rid",this.uid)),this.setUpdateInterval(this._updateTimeout),this.pers!=k.storageTypes.CK&&this.pers!=k.storageTypes.DS||this._maint(!1,!0),this._readyState.fire(this),this.ready.fire(this)}.bind(this))}.bind(this),!0,!0),k.Bind(window,"unload",function(){this.save(!0)}.bind(this))};O.prototype.selectCookieDomain=function(t,i){if(!e.isDefined(t)||!Array.isArray(t)||t.length<1)return k.getRootDomain();var r,n,a;for(n=0;n<t.length;n++)if((a=t[n])&&a.path&&a.domain&&k.testAgainstSearch(a.path,i)){r=a;break}return r&&e.isString(r.domain)?r.domain:null},O.prototype.upgradeOldStorage=function(i){var r=this.ckie,n=["fsr.r","fsr.s","_fsspl_","fsr.t","acs.t"],a=!1;this.pers===k.storageTypes.MC&&n.push("_4c_");for(var s=0;s<n.length;s++)if(r.get(n[s])){a=!0;break}a?t([e.makeURI("$fs.storageupgrade.js")],function(t){t(this,r,i)}.bind(this)):e.nextTick(i)},O.prototype.watchForChanges=function(t,e,i,r){Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var a=t[n];this._keyEvents[a]||(this._keyEvents[a]=new k.FSEvent),this._keyEvents[a].subscribe(e,i,r)}},O.prototype.setUpdateInterval=function(t,i){t&&!isNaN(t)&&(this._updateTimeout=t,clearInterval(this._updateInterval),this._updateInterval=setInterval(e.proxy(function(){this._sync(i)},this),t))},O.prototype._sync=function(t,i){var r=this[t&&this.brainOnlyComms?"_tracker":"_general"];if(!r.isSyncing){r.isSyncing=!0,i=i||function(){};var n,a;if(t||this.pers!=k.storageTypes.CK)if(t||this.pers!=k.storageTypes.DS){if(this._serverFails>5)return;this._readyState.didFire&&(this._readyState=new k.FSEvent),k.Healthy(this.browser,this._healthyServices,function(){this.cors.send({method:"GET",url:e.config.brainUrl+"/state/"+e.config.siteKey+"/"+this.uid,success:function(t){r.lastSync=k.now(),a=JSON.parse(t),this.timeOffset=k.isNumeric(a._asof_)?k.now()-a._asof_:0,this._fireChangeEvents(a.keys),r.data=a,r.isSyncing=!1,e.nextTick(function(){this.onSync.fire(this),this._readyState.fire(this)}.bind(this)),i()}.bind(this),failure:function(){r.lastSync=k.now(),r.isSyncing=!1,this._serverFails++,this._readyState.fire(this)}.bind(this)})}.bind(this))}else{if(n=localStorage.getItem(this._storageKey)){if(n=G.decompress(n),r.lastSync=k.now(),a=JSON.parse(n),a.keys=a.keys||{},this._fireChangeEvents(a.keys),r.data=a,e.nextTick(function(){this.onSync.fire(this)}.bind(this)),k.now()-this._general.data.when<3e5)return r.isSyncing=!1,void e.nextTick(i);r.lastSync=k.now(),r.data={when:k.now(),keys:{}}}r.isSyncing=!1,e.nextTick(i)}else{if(n=this.ckie.get(this._storageKey))return n=G.decompress(n),this._lastSync=k.now(),a=JSON.parse(n),this._fireChangeEvents(a.keys),a.keys=a.keys||{},r.data=a,this.onSync.fire(this),r.isSyncing=!1,void e.nextTick(i);r.isSyncing=!1,e.nextTick(i)}}},O.prototype._fireChangeEvents=function(t){var i,r=this;for(var n in t)(!(i=this._general.data.keys[n])||i.t<t[n].t||i.x!==t[n].x)&&(this._keyEvents[n]||(this._keyEvents[n]=new k.FSEvent),e.nextTick(function(e){return function(){r._keyEvents[e].fire(e,r._general.data.keys[e],t[e].v)}}(n)))},O.prototype.save=function(t,e){var i=this[e&&this.brainOnlyComms?"_tracker":"_general"];if(t)this._commit(e);else{var r=k.now();!i.lock&&i.isStale&&(i.lock=setTimeout(this._commit.bind(this,e),Math.max(0,i.cThreshold-(r-i.lastSave))))}},O.prototype._commit=function(t){var i=this[t&&this.brainOnlyComms?"_tracker":"_general"];clearTimeout(i.lock),i.lock=null,i.lastSave=k.now(),i.data.when=i.lastSave;var r="";try{r=JSON.stringify(i.data)}catch(t){return}if(t||this.pers!=k.storageTypes.CK)t||this.pers!=k.storageTypes.DS||(localStorage.setItem(this._storageKey,G.compress(r)),this.onCommit.fire(i.data));else{var n=e.ext({},i.data);for(var a in n.keys)delete n.keys[a].t;r=JSON.stringify(n),this.ckie.set(this._storageKey,G.compress(r)),this.onCommit.fire(i.data)}if(t||!this.brainOnlyComms){if(this._serverFails>5)return;this._readyState.didFire&&(this._readyState=new k.FSEvent),k.Healthy(this.browser,this._healthyServices,function(){this.cors.send({method:"POST",url:e.config.brainUrl+"/state/"+e.config.siteKey+"/"+this.uid,data:i.data,contentType:"application/json",success:function(t){this._lastSync=k.now(),i.data=JSON.parse(t),this.onCommit.fire(i.data),this._readyState.fire(this)}.bind(this),failure:function(){this._serverFails++,this._readyState.fire(this)}.bind(this)})}.bind(this))}this.isStale=!1},O.prototype._maint=function(t,e){var i,r=k.now(),n=!1,a=this[t&&this.brainOnlyComms?"_tracker":"_general"],s=a.data.keys;if(r-a.lastMaint>5e3||e){for(var o in s)i=s[o],r-this.timeOffset>i.x&&(delete s[o],n=!0);a.lastMaint=r}n&&!t&&this.brainOnlyComms&&this._commit()},O.prototype.set=function(t,i,r,n,a,s){this._readyState.subscribe(function(){var o=a===k.persistDataType.TRACKER,f=this[o&&this.brainOnlyComms?"_tracker":"_general"];f.data.keys||(f.data.keys={});var h=f.data.keys[t],u=k.now(),l=null;if(r)if("number"==typeof r)l=r,this.maxExpire>0&&this.maxExpire<r&&(l=r=this.maxExpire),r=u+r;else if(r instanceof Date&&(r=r.getTime()+r,this.maxExpire>0)){var c=r-u;c>this.maxExpire&&(l=r=this.maxExpire,r=u+r)}if(h){var d={};d[t]={v:i,x:r||h.x,t:u},this._fireChangeEvents(d),h.v="cp"==t?e.ext(h.v,i):"ckcpps"==t?e.ext(h.v,i):i,h.x=r||h.x,l&&(h.ttl=l),h.t=u}else{var p={};p[t]={v:i,x:r||this.defaultExpire+u,t:u},l&&(p[t].ttl=l),this._fireChangeEvents(p),f.data.keys[t]=p[t]}f.isStale=!0,s&&this.onCommit.subscribe(s,!0,!1),this._maint(o),this.save(!!n,o)}.bind(this),!0,!0)},O.prototype.get=function(t){if(Array.isArray(t)){for(var e={},i=0;i<t.length;i++)e[t[i]]=this.get(t[i]);return e}return this._maint(),this._general.data.keys||(this._general.data.keys={}),(this._general.data.keys[t]||{v:null}).v},O.prototype.all=function(){return this._general.data.keys},O.prototype.erase=function(t,i,r){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.erase(t[n]);else this._maint(),delete this._general.data.keys[t],i&&this.onCommit.subscribe(i,!0,!1),this.pers==k.storageTypes.CL||this.pers==k.storageTypes.MC?(this._readyState.didFire&&(this._readyState=new k.FSEvent),k.Healthy(this.browser,this._healthyServices,function(){this.cors.send({method:"DELETE",url:e.config.brainUrl+"/state/"+e.config.siteKey+"/"+this.uid+"/"+e.enc(t),contentType:"application/json",success:function(t){this._lastSync=k.now(),this.onCommit.fire(this._tracker.data),this._readyState.fire(this)}.bind(this),failure:function(){this._serverFails++,this._readyState.fire(this)}.bind(this)})}.bind(this))):this.save(!!r)},O.prototype.reset=function(t,i,r){var n=document.getElementById("acsOverrideSettings"),a=document.getElementById("acsClearStateWaitMessage"),s=!!n&&!!a;if(this._general.data.keys={},t&&this.onCommit.subscribe(t,!0,!1),r||(this.ckie.kill(this._storageKey),this.ckie.kill(this._microStorageKey)),this.pers==k.storageTypes.CK){if(localStorage&&e.supportsDomStorage)for(var o in localStorage)/^(_fsr|__fsFr)/.test(o)&&localStorage.removeItem(o);this.onCommit.fire()}else this.pers==k.storageTypes.DS?(localStorage.removeItem(this._storageKey),this.onCommit.fire()):(this._readyState.didFire&&(this._readyState=new k.FSEvent),s&&(k.addClass(n,"acsNoDisplay"),k.removeClass(a,"acsNoDisplay")),k.Healthy(this.browser,this._healthyServices,function(){this.cors.send({method:"DELETE",url:e.config.brainUrl+"/state/"+e.config.siteKey+"/"+this.uid,success:function(){s&&(k.removeClass(n,"acsNoDisplay"),k.addClass(a,"acsNoDisplay")),this._general.lastSync=k.now()-1e4,this.onCommit.fire(),this._readyState.fire(this)}.bind(this),failure:function(){s&&(k.removeClass(n,"acsNoDisplay"),k.addClass(a,"acsNoDisplay"),i&&i()),this._serverFails++,this._readyState.fire(this)}.bind(this)})}.bind(this)))},O.prototype.setMaxKeyExpiration=function(t){this.maxExpire=this.defaultExpire=t;var e,i=k.now(),r=this._general.data.keys;for(var n in r){e=r[n];var a=e.x-i;(a>t||e.ttl>t)&&(e.ttl=t,e.x&&(e.x-=a-t))}this.save(!0)},O.prototype.getMaxKeyExpiration=function(){var t=k.now(),e=this._general.data.keys,i=0;for(var r in e)i=Math.max(i,e[r].x-t);return i};var L;k.getGlobalStore=function(t,e){return L||(L=new O(t,e)),L},k.FULL_DAY=864e5,k.now=function(){return+new Date},k.startTime=k.now();var N=function(t,e){this.loadSuccess=new k.FSEvent,this.loadFailure=new k.FSEvent,this.st=document.createElement("script"),this.st.type="text/javascript",this.st.src=t,e&&(this.st.id=e),this.br=k.getBrowserInstance(),void 0!==this.st.addEventListener?this._loadOnOthers():void 0!==this.st.attachEvent&&this._loadOnIE()};N.prototype._loadOnIE=function(){var t=this,e=this.st;e.onreadystatechange=function(){3==e.readyState&&(e.onreadystatechange=function(){t.loadSuccess.fire(e.src),t.loadFailure=null},t.loadFailure&&t.loadFailure.fire(e.src))},document.body.appendChild(e)},N.prototype._loadOnOthers=function(){this.st.addEventListener("load",e.proxy(function(){this.loadSuccess.fire(this.st.src)},this),!1),this.st.addEventListener("error",e.proxy(function(){this.loadFailure.fire(this.st.src)},this),!1),document.body.appendChild(this.st)};var F={Util:{stringToByteArray:function(t){var e,i,r=t.split("");for(e=0,i=r.length;e<i;e++)r[e]=(255&r[e].charCodeAt(0))>>>0;return r}}};F.CompressionMethod={DEFLATE:8,RESERVED:15},F.BitStream=function(t,e){if(this.index="number"==typeof e?e:0,this.bitindex=0,this.buffer=t instanceof(x?Uint8Array:Array)?t:new(x?Uint8Array:Array)(F.BitStream.DefaultBlockSize),2*this.buffer.length<=this.index)throw new Error("invalid index");this.buffer.length<=this.index&&this.expandBuffer()},F.BitStream.DefaultBlockSize=32768,F.BitStream.prototype.expandBuffer=function(){var t,e=this.buffer,i=e.length,r=new(x?Uint8Array:Array)(i<<1);if(x)r.set(e);else for(t=0;t<i;++t)r[t]=e[t];return this.buffer=r},F.BitStream.prototype.writeBits=function(t,e,i){var r,n=this.buffer,a=this.index,s=this.bitindex,o=n[a];if(i&&e>1&&(t=e>8?function(t){return F.BitStream.ReverseTable[255&t]<<24|F.BitStream.ReverseTable[t>>>8&255]<<16|F.BitStream.ReverseTable[t>>>16&255]<<8|F.BitStream.ReverseTable[t>>>24&255]}(t)>>32-e:F.BitStream.ReverseTable[t]>>8-e),e+s<8)o=o<<e|t,s+=e;else for(r=0;r<e;++r)o=o<<1|t>>e-r-1&1,8==++s&&(s=0,n[a++]=F.BitStream.ReverseTable[o],o=0,a===n.length&&(n=this.expandBuffer()));n[a]=o,this.buffer=n,this.bitindex=s,this.index=a},F.BitStream.prototype.finish=function(){var t,e=this.buffer,i=this.index;return this.bitindex>0&&(e[i]<<=8-this.bitindex,e[i]=F.BitStream.ReverseTable[e[i]],i++),x?t=e.subarray(0,i):(e.length=i,t=e),t},F.BitStream.ReverseTable=function(t){return t}(function(){var t,e=new(x?Uint8Array:Array)(256);for(t=0;t<256;++t)e[t]=function(t){var e=t,i=7;for(t>>>=1;t;t>>>=1)e<<=1,e|=1&t,--i;return(e<<i&255)>>>0}(t);return e}()),F.Huffman={},F.Huffman.buildHuffmanTable=function(t){var e,i,r,n,a,s,o,f,h,u,l,c=t.length,d=0,p=Number.POSITIVE_INFINITY;for(f=0,h=c;f<h;++f)t[f]>d&&(d=t[f]),t[f]<p&&(p=t[f]);for(e=1<<d,i=new(x?Uint32Array:Array)(e),r=1,n=0,a=2;r<=d;){for(f=0;f<c;++f)if(t[f]===r){for(s=0,o=n,u=0;u<r;++u)s=s<<1|1&o,o>>=1;for(l=r<<16|f,u=s;u<e;u+=a)i[u]=l;++n}++r,n<<=1,a<<=1}return[i,d,p]},F.Heap=function(t){this.buffer=new(x?Uint16Array:Array)(2*t),this.length=0},F.Heap.prototype.getParent=function(t){return 2*((t-2)/4|0)},F.Heap.prototype.getChild=function(t){return 2*t+2},F.Heap.prototype.push=function(t,e){var i,r,n,a=this.buffer;for(i=this.length,a[this.length++]=e,a[this.length++]=t;i>0&&(r=this.getParent(i),a[i]>a[r]);)n=a[i],a[i]=a[r],a[r]=n,n=a[i+1],a[i+1]=a[r+1],a[r+1]=n,i=r;return this.length},F.Heap.prototype.pop=function(){var t,e,i,r,n,a=this.buffer;for(e=a[0],t=a[1],this.length-=2,a[0]=a[this.length],a[1]=a[this.length+1],n=0;;){if((r=this.getChild(n))>=this.length)break;if(r+2<this.length&&a[r+2]>a[r]&&(r+=2),!(a[r]>a[n]))break;i=a[n],a[n]=a[r],a[r]=i,i=a[n+1],a[n+1]=a[r+1],a[r+1]=i,n=r}return{index:t,value:e,length:this.length}},F.RawDeflate=function(t,e){this.compressionType=F.RawDeflate.CompressionType.DYNAMIC,this.lazy=0,this.freqsLitLen,this.freqsDist,this.input=x&&t instanceof Array?new Uint8Array(t):t,this.output,this.op=0,e&&(e.lazy&&(this.lazy=e.lazy),"number"==typeof e.compressionType&&(this.compressionType=e.compressionType),e.outputBuffer&&(this.output=x&&e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.op=e.outputIndex)),this.output||(this.output=new(x?Uint8Array:Array)(32768))},F.RawDeflate.CompressionType={NONE:0,FIXED:1,DYNAMIC:2,RESERVED:3},F.RawDeflate.Lz77MinLength=3,F.RawDeflate.Lz77MaxLength=258,F.RawDeflate.WindowSize=32768,F.RawDeflate.MaxCodeLength=16,F.RawDeflate.HUFMAX=286,F.RawDeflate.FixedHuffmanTable=function(){var t,e=[];for(t=0;t<288;t++)switch(!0){case t<=143:e.push([t+48,8]);break;case t<=255:e.push([t-144+400,9]);break;case t<=279:e.push([t-256+0,7]);break;case t<=287:e.push([t-280+192,8]);break;default:throw"invalid literal: "+t}return e}(),F.RawDeflate.prototype.compress=function(){var t,e,i,r=this.input;switch(this.compressionType){case F.RawDeflate.CompressionType.NONE:for(e=0,i=r.length;e<i;)t=x?r.subarray(e,e+65535):r.slice(e,e+65535),e+=t.length,this.makeNocompressBlock(t,e===i);break;case F.RawDeflate.CompressionType.FIXED:this.output=this.makeFixedHuffmanBlock(r,!0),this.op=this.output.length;break;case F.RawDeflate.CompressionType.DYNAMIC:this.output=this.makeDynamicHuffmanBlock(r,!0),this.op=this.output.length;break;default:throw"invalid compression type"}return this.output},F.RawDeflate.prototype.makeNocompressBlock=function(t,e){var i,r,n,a,s,o,f=this.output,h=this.op;if(x){for(f=new Uint8Array(this.output.buffer);f.length<=h+t.length+5;)f=new Uint8Array(f.length<<1);f.set(this.output)}if(i=e?1:0,r=F.RawDeflate.CompressionType.NONE,f[h++]=i|r<<1,n=t.length,a=65536+~n&65535,f[h++]=255&n,f[h++]=n>>>8&255,f[h++]=255&a,f[h++]=a>>>8&255,x)f.set(t,h),h+=t.length,f=f.subarray(0,h);else{for(s=0,o=t.length;s<o;++s)f[h++]=t[s];f.length=h}return this.op=h,this.output=f,f},F.RawDeflate.prototype.makeFixedHuffmanBlock=function(t,e){var i,r,n,a=new F.BitStream(x?new Uint8Array(this.output.buffer):this.output,this.op);return i=e?1:0,r=F.RawDeflate.CompressionType.FIXED,a.writeBits(i,1,!0),a.writeBits(r,2,!0),n=this.lz77(t),this.fixedHuffman(n,a),a.finish()},F.RawDeflate.prototype.makeDynamicHuffmanBlock=function(t,e){var i,r,n,a,s,o,f,h,u,l,c,d,p,g,y,b,w,v=new F.BitStream(x?new Uint8Array(this.output.buffer):this.output,this.op),m=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=new Array(19);for(i=e?1:0,r=F.RawDeflate.CompressionType.DYNAMIC,v.writeBits(i,1,!0),v.writeBits(r,2,!0),n=this.lz77(t),f=this.getLengths_(this.freqsLitLen,15),h=this.getCodesFromLengths_(f),u=this.getLengths_(this.freqsDist,7),l=this.getCodesFromLengths_(u),a=286;a>257&&0===f[a-1];a--);for(s=30;s>1&&0===u[s-1];s--);for(c=this.getTreeSymbols_(a,f,s,u),d=this.getLengths_(c.freqs,7),b=0;b<19;b++)S[b]=d[m[b]];for(o=19;o>4&&0===S[o-1];o--);for(p=this.getCodesFromLengths_(d),
v.writeBits(a-257,5,!0),v.writeBits(s-1,5,!0),v.writeBits(o-4,4,!0),b=0;b<o;b++)v.writeBits(S[b],3,!0);for(b=0,w=c.codes.length;b<w;b++)if(g=c.codes[b],v.writeBits(p[g],d[g],!0),g>=16){switch(b++,g){case 16:y=2;break;case 17:y=3;break;case 18:y=7;break;default:throw"invalid code: "+g}v.writeBits(c.codes[b],y,!0)}return this.dynamicHuffman(n,[h,f],[l,u],v),v.finish()},F.RawDeflate.prototype.dynamicHuffman=function(t,e,i,r){var n,a,s,o,f,h,u,l;for(f=e[0],h=e[1],u=i[0],l=i[1],n=0,a=t.length;n<a;++n)if(s=t[n],r.writeBits(f[s],h[s],!0),s>256)r.writeBits(t[++n],t[++n],!0),o=t[++n],r.writeBits(u[o],l[o],!0),r.writeBits(t[++n],t[++n],!0);else if(256===s)break;return r},F.RawDeflate.prototype.fixedHuffman=function(t,e){var i,r,n;for(i=0,r=t.length;i<r;i++)if(n=t[i],F.BitStream.prototype.writeBits.apply(e,F.RawDeflate.FixedHuffmanTable[n]),n>256)e.writeBits(t[++i],t[++i],!0),e.writeBits(t[++i],5),e.writeBits(t[++i],t[++i],!0);else if(256===n)break;return e},F.RawDeflate.Lz77Match=function(t,e){this.length=t,this.backwardDistance=e},F.RawDeflate.Lz77Match.LengthCodeTable=function(t){return x?new Uint32Array(t):t}(function(){var t,e,i=[];for(t=3;t<=258;t++)e=function(t){switch(!0){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case t<=12:return[265,t-11,1];case t<=14:return[266,t-13,1];case t<=16:return[267,t-15,1];case t<=18:return[268,t-17,1];case t<=22:return[269,t-19,2];case t<=26:return[270,t-23,2];case t<=30:return[271,t-27,2];case t<=34:return[272,t-31,2];case t<=42:return[273,t-35,3];case t<=50:return[274,t-43,3];case t<=58:return[275,t-51,3];case t<=66:return[276,t-59,3];case t<=82:return[277,t-67,4];case t<=98:return[278,t-83,4];case t<=114:return[279,t-99,4];case t<=130:return[280,t-115,4];case t<=162:return[281,t-131,5];case t<=194:return[282,t-163,5];case t<=226:return[283,t-195,5];case t<=257:return[284,t-227,5];case 258===t:return[285,t-258,0];default:throw"invalid length: "+t}}(t),i[t]=e[2]<<24|e[1]<<16|e[0];return i}()),F.RawDeflate.Lz77Match.prototype.getDistanceCode_=function(t){var e;switch(!0){case 1===t:e=[0,t-1,0];break;case 2===t:e=[1,t-2,0];break;case 3===t:e=[2,t-3,0];break;case 4===t:e=[3,t-4,0];break;case t<=6:e=[4,t-5,1];break;case t<=8:e=[5,t-7,1];break;case t<=12:e=[6,t-9,2];break;case t<=16:e=[7,t-13,2];break;case t<=24:e=[8,t-17,3];break;case t<=32:e=[9,t-25,3];break;case t<=48:e=[10,t-33,4];break;case t<=64:e=[11,t-49,4];break;case t<=96:e=[12,t-65,5];break;case t<=128:e=[13,t-97,5];break;case t<=192:e=[14,t-129,6];break;case t<=256:e=[15,t-193,6];break;case t<=384:e=[16,t-257,7];break;case t<=512:e=[17,t-385,7];break;case t<=768:e=[18,t-513,8];break;case t<=1024:e=[19,t-769,8];break;case t<=1536:e=[20,t-1025,9];break;case t<=2048:e=[21,t-1537,9];break;case t<=3072:e=[22,t-2049,10];break;case t<=4096:e=[23,t-3073,10];break;case t<=6144:e=[24,t-4097,11];break;case t<=8192:e=[25,t-6145,11];break;case t<=12288:e=[26,t-8193,12];break;case t<=16384:e=[27,t-12289,12];break;case t<=24576:e=[28,t-16385,13];break;case t<=32768:e=[29,t-24577,13];break;default:throw"invalid distance"}return e},F.RawDeflate.Lz77Match.prototype.toLz77Array=function(){var t,e=this.length,i=this.backwardDistance,r=[],n=0;return t=F.RawDeflate.Lz77Match.LengthCodeTable[e],r[n++]=65535&t,r[n++]=t>>16&255,r[n++]=t>>24,t=this.getDistanceCode_(i),r[n++]=t[0],r[n++]=t[1],r[n++]=t[2],r},F.RawDeflate.prototype.lz77=function(t){function e(t,e){var i,r,n=t.toLz77Array();for(i=0,r=n.length;i<r;++i)d[p++]=n[i];y[n[0]]++,b[n[3]]++,g=t.length+e-1,h=null}var i,r,n,a,s,o,f,h,u,l={},c=F.RawDeflate.WindowSize,d=x?new Uint16Array(2*t.length):[],p=0,g=0,y=new(x?Uint32Array:Array)(286),b=new(x?Uint32Array:Array)(30),w=this.lazy;if(!x){for(n=0;n<=285;)y[n++]=0;for(n=0;n<=29;)b[n++]=0}for(y[256]=1,i=0,r=t.length;i<r;++i){for(s=0,n=0,a=F.RawDeflate.Lz77MinLength;n<a&&i+n!==r;++n)s=s<<8|t[i+n];if(void 0===l[s]&&(l[s]=[]),o=l[s],g-- >0)o.push(i);else{for(;o.length>0&&i-o[0]>c;)o.shift();if(i+F.RawDeflate.Lz77MinLength>=r){for(h&&e(h,-1),n=0,a=r-i;n<a;++n)u=t[i+n],d[p++]=u,++y[u];break}o.length>0?(f=this.searchLongestMatch_(t,i,o),h?h.length<f.length?(u=t[i-1],d[p++]=u,++y[u],e(f,0)):e(h,-1):f.length<w?h=f:e(f,0)):h?e(h,-1):(u=t[i],d[p++]=u,++y[u]),o.push(i)}}return d[p++]=256,y[256]++,this.freqsLitLen=y,this.freqsDist=b,x?d.subarray(0,p):d},F.RawDeflate.prototype.searchLongestMatch_=function(t,e,i){var r,n,a,s,o,f,h=0,u=t.length;t:for(s=0,f=i.length;s<f;s++){if(r=i[f-s-1],a=F.RawDeflate.Lz77MinLength,h>F.RawDeflate.Lz77MinLength){for(o=h;o>F.RawDeflate.Lz77MinLength;o--)if(t[r+o-1]!==t[e+o-1])continue t;a=h}for(;a<F.RawDeflate.Lz77MaxLength&&e+a<u&&t[r+a]===t[e+a];)++a;if(a>h&&(n=r,h=a),a===F.RawDeflate.Lz77MaxLength)break}return new F.RawDeflate.Lz77Match(h,e-n)},F.RawDeflate.prototype.getTreeSymbols_=function(t,e,i,r){var n,a,s,o,f,h,u=new(x?Uint32Array:Array)(t+i),l=new(x?Uint32Array:Array)(316),c=new(x?Uint8Array:Array)(19);for(a=0,n=0;n<t;n++)u[a++]=e[n];for(n=0;n<i;n++)u[a++]=r[n];if(!x)for(n=0,o=c.length;n<o;++n)c[n]=0;for(f=0,n=0,o=u.length;n<o;n+=a){for(a=1;n+a<o&&u[n+a]===u[n];++a);if(s=a,0===u[n])if(s<3)for(;s-- >0;)l[f++]=0,c[0]++;else for(;s>0;)h=s<138?s:138,h>s-3&&h<s&&(h=s-3),h<=10?(l[f++]=17,l[f++]=h-3,c[17]++):(l[f++]=18,l[f++]=h-11,c[18]++),s-=h;else if(l[f++]=u[n],c[u[n]]++,--s<3)for(;s-- >0;)l[f++]=u[n],c[u[n]]++;else for(;s>0;)h=s<6?s:6,h>s-3&&h<s&&(h=s-3),l[f++]=16,l[f++]=h-3,c[16]++,s-=h}return{codes:x?l.subarray(0,f):l.slice(0,f),freqs:c}},F.RawDeflate.prototype.getLengths_=function(t,e){var i,r,n,a,s,o=t.length,f=new F.Heap(2*F.RawDeflate.HUFMAX),h=new(x?Uint8Array:Array)(o);if(!x)for(a=0;a<o;a++)h[a]=0;for(a=0;a<o;++a)t[a]>0&&f.push(a,t[a]);if(i=new Array(f.length/2),r=new(x?Uint32Array:Array)(f.length/2),1===i.length)return h[f.pop().index]=1,h;for(a=0,s=f.length/2;a<s;++a)i[a]=f.pop(),r[a]=i[a].value;for(n=this.reversePackageMerge_(r,r.length,e),a=0,s=i.length;a<s;++a)h[i[a].index]=n[a];return h},F.RawDeflate.prototype.reversePackageMerge_=function(t,e,i){function r(t){var i=d[t][p[t]];i===e?(r(t+1),r(t+1)):--l[i],++p[t]}var n,a,s,o,f,h=new(x?Uint16Array:Array)(i),u=new(x?Uint8Array:Array)(i),l=new(x?Uint8Array:Array)(e),c=new Array(i),d=new Array(i),p=new Array(i),g=(1<<i)-e,y=1<<i-1;for(h[i-1]=e,a=0;a<i;++a)g<y?u[a]=0:(u[a]=1,g-=y),g<<=1,h[i-2-a]=(h[i-1-a]/2|0)+e;for(h[0]=u[0],c[0]=new Array(h[0]),d[0]=new Array(h[0]),a=1;a<i;++a)h[a]>2*h[a-1]+u[a]&&(h[a]=2*h[a-1]+u[a]),c[a]=new Array(h[a]),d[a]=new Array(h[a]);for(n=0;n<e;++n)l[n]=i;for(s=0;s<h[i-1];++s)c[i-1][s]=t[s],d[i-1][s]=s;for(n=0;n<i;++n)p[n]=0;for(1===u[i-1]&&(--l[0],++p[i-1]),a=i-2;a>=0;--a){for(n=0,o=0,f=p[a+1],s=0;s<h[a];s++)o=c[a+1][f]+c[a+1][f+1],o>t[n]?(c[a][s]=o,d[a][s]=e,f+=2):(c[a][s]=t[n],d[a][s]=n,++n);p[a]=0,1===u[a]&&r(a)}return l},F.RawDeflate.prototype.getCodesFromLengths_=function(t){var e,i,r,n,a=new(x?Uint16Array:Array)(t.length),s=[],o=[],f=0;for(e=0,i=t.length;e<i;e++)s[t[e]]=1+(0|s[t[e]]);for(e=1,i=F.RawDeflate.MaxCodeLength;e<=i;e++)o[e]=f,f+=0|s[e],f<<=1;for(e=0,i=t.length;e<i;e++)for(f=o[t[e]],o[t[e]]+=1,a[e]=0,r=0,n=t[e];r<n;r++)a[e]=a[e]<<1|1&f,f>>>=1;return a};var U=F.Huffman.buildHuffmanTable;if(F.RawInflate=function(t,e){switch(this.buffer,this.blocks=[],this.bufferSize=ZLIB_RAW_INFLATE_BUFFER_SIZE,this.totalpos=0,this.ip=0,this.bitsbuf=0,this.bitsbuflen=0,this.input=x?new Uint8Array(t):t,this.output,this.op,this.bfinal=!1,this.bufferType=F.RawInflate.BufferType.ADAPTIVE,this.resize=!1,this.prev,!e&&(e={})||(e.index&&(this.ip=e.index),e.bufferSize&&(this.bufferSize=e.bufferSize),e.bufferType&&(this.bufferType=e.bufferType),e.resize&&(this.resize=e.resize)),this.bufferType){case F.RawInflate.BufferType.BLOCK:this.op=F.RawInflate.MaxBackwardLength,this.output=new(x?Uint8Array:Array)(F.RawInflate.MaxBackwardLength+this.bufferSize+F.RawInflate.MaxCopyLength);break;case F.RawInflate.BufferType.ADAPTIVE:this.op=0,this.output=new(x?Uint8Array:Array)(this.bufferSize),this.expandBuffer=this.expandBufferAdaptive,this.concatBuffer=this.concatBufferDynamic,this.decodeHuffman=this.decodeHuffmanAdaptive;break;default:throw new Error("invalid inflate mode")}},F.RawInflate.BufferType={BLOCK:0,ADAPTIVE:1},F.RawInflate.prototype.decompress=function(){for(;!this.bfinal;)this.parseBlock();return this.concatBuffer()},F.RawInflate.MaxBackwardLength=32768,F.RawInflate.MaxCopyLength=258,F.RawInflate.Order=function(t){return x?new Uint16Array(t):t}([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),F.RawInflate.LengthCodeTable=function(t){return x?new Uint16Array(t):t}([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),F.RawInflate.LengthExtraTable=function(t){return x?new Uint8Array(t):t}([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),F.RawInflate.DistCodeTable=function(t){return x?new Uint16Array(t):t}([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),F.RawInflate.DistExtraTable=function(t){return x?new Uint8Array(t):t}([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),F.RawInflate.FixedLiteralLengthTable=function(t){return t}(function(){var t,e,i=new(x?Uint8Array:Array)(288);for(t=0,e=i.length;t<e;++t)i[t]=t<=143?8:t<=255?9:t<=279?7:8;return U(i)}()),F.RawInflate.FixedDistanceTable=function(t){return t}(function(){var t,e,i=new(x?Uint8Array:Array)(30);for(t=0,e=i.length;t<e;++t)i[t]=5;return U(i)}()),F.RawInflate.prototype.parseBlock=function(){var t=this.readBits(3);switch(1&t&&(this.bfinal=!0),t>>>=1){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw new Error("unknown BTYPE: "+t)}},F.RawInflate.prototype.readBits=function(t){for(var e,i=this.bitsbuf,r=this.bitsbuflen,n=this.input,a=this.ip,s=n.length;r<t;){if(a>=s)throw new Error("input buffer is broken");i|=n[a++]<<r,r+=8}return e=i&(1<<t)-1,i>>>=t,r-=t,this.bitsbuf=i,this.bitsbuflen=r,this.ip=a,e},F.RawInflate.prototype.readCodeByTable=function(t){for(var e,i,r=this.bitsbuf,n=this.bitsbuflen,a=this.input,s=this.ip,o=a.length,f=t[0],h=t[1];n<h&&!(s>=o);)r|=a[s++]<<n,n+=8;return e=f[r&(1<<h)-1],i=e>>>16,this.bitsbuf=r>>i,this.bitsbuflen=n-i,this.ip=s,65535&e},F.RawInflate.prototype.parseUncompressedBlock=function(){var t,e,i,r=this.input,n=this.ip,a=this.output,s=this.op,o=r.length,f=a.length;if(this.bitsbuf=0,this.bitsbuflen=0,n+1>=o)throw new Error("invalid uncompressed block header: LEN");if(t=r[n++]|r[n++]<<8,n+1>=o)throw new Error("invalid uncompressed block header: NLEN");if(e=r[n++]|r[n++]<<8,t===~e)throw new Error("invalid uncompressed block header: length verify");if(n+t>r.length)throw new Error("input buffer is broken");switch(this.bufferType){case F.RawInflate.BufferType.BLOCK:for(;s+t>a.length;){if(i=f-s,t-=i,x)a.set(r.subarray(n,n+i),s),s+=i,n+=i;else for(;i--;)a[s++]=r[n++];this.op=s,a=this.expandBuffer(),s=this.op}break;case F.RawInflate.BufferType.ADAPTIVE:for(;s+t>a.length;)a=this.expandBuffer({fixRatio:2});break;default:throw new Error("invalid inflate mode")}if(x)a.set(r.subarray(n,n+t),s),s+=t,n+=t;else for(;t--;)a[s++]=r[n++];this.ip=n,this.op=s,this.output=a},F.RawInflate.prototype.parseFixedHuffmanBlock=function(){this.decodeHuffman(F.RawInflate.FixedLiteralLengthTable,F.RawInflate.FixedDistanceTable)},F.RawInflate.prototype.parseDynamicHuffmanBlock=function(){function t(t,e,i){var r,n,a,s=this.prev;for(a=0;a<t;)switch(r=this.readCodeByTable(e)){case 16:for(n=3+this.readBits(2);n--;)i[a++]=s;break;case 17:for(n=3+this.readBits(3);n--;)i[a++]=0;s=0;break;case 18:for(n=11+this.readBits(7);n--;)i[a++]=0;s=0;break;default:i[a++]=r,s=r}return this.prev=s,i}var e,i,r,n,a=this.readBits(5)+257,s=this.readBits(5)+1,o=this.readBits(4)+4,f=new(x?Uint8Array:Array)(F.RawInflate.Order.length);for(n=0;n<o;++n)f[F.RawInflate.Order[n]]=this.readBits(3);if(!x)for(n=o,o=f.length;n<o;++n)f[F.RawInflate.Order[n]]=0;e=U(f),i=new(x?Uint8Array:Array)(a),r=new(x?Uint8Array:Array)(s),this.prev=0,this.decodeHuffman(U(t.call(this,a,e,i)),U(t.call(this,s,e,r)))},F.RawInflate.prototype.decodeHuffman=function(t,e){var i=this.output,r=this.op;this.currentLitlenTable=t;for(var n,a,s,o,f=i.length-F.RawInflate.MaxCopyLength;256!==(n=this.readCodeByTable(t));)if(n<256)r>=f&&(this.op=r,i=this.expandBuffer(),r=this.op),i[r++]=n;else for(a=n-257,o=F.RawInflate.LengthCodeTable[a],F.RawInflate.LengthExtraTable[a]>0&&(o+=this.readBits(F.RawInflate.LengthExtraTable[a])),n=this.readCodeByTable(e),s=F.RawInflate.DistCodeTable[n],F.RawInflate.DistExtraTable[n]>0&&(s+=this.readBits(F.RawInflate.DistExtraTable[n])),r>=f&&(this.op=r,i=this.expandBuffer(),r=this.op);o--;)i[r]=i[r++-s];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=r},F.RawInflate.prototype.decodeHuffmanAdaptive=function(t,e){var i=this.output,r=this.op;this.currentLitlenTable=t;for(var n,a,s,o,f=i.length;256!==(n=this.readCodeByTable(t));)if(n<256)r>=f&&(i=this.expandBuffer(),f=i.length),i[r++]=n;else for(a=n-257,o=F.RawInflate.LengthCodeTable[a],F.RawInflate.LengthExtraTable[a]>0&&(o+=this.readBits(F.RawInflate.LengthExtraTable[a])),n=this.readCodeByTable(e),s=F.RawInflate.DistCodeTable[n],F.RawInflate.DistExtraTable[n]>0&&(s+=this.readBits(F.RawInflate.DistExtraTable[n])),r+o>f&&(i=this.expandBuffer(),f=i.length);o--;)i[r]=i[r++-s];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=r},F.RawInflate.prototype.expandBuffer=function(t){var e,i,r=new(x?Uint8Array:Array)(this.op-F.RawInflate.MaxBackwardLength),n=this.op-F.RawInflate.MaxBackwardLength,a=this.output;if(x)r.set(a.subarray(F.RawInflate.MaxBackwardLength,r.length));else for(e=0,i=r.length;e<i;++e)r[e]=a[e+F.RawInflate.MaxBackwardLength];if(this.blocks.push(r),this.totalpos+=r.length,x)a.set(a.subarray(n,n+F.RawInflate.MaxBackwardLength));else for(e=0;e<F.RawInflate.MaxBackwardLength;++e)a[e]=a[n+e];return this.op=F.RawInflate.MaxBackwardLength,a},F.RawInflate.prototype.expandBufferAdaptive=function(t){var e,i,r,n,a=this.input.length/this.ip+1|0,s=this.input,o=this.output;return t&&("number"==typeof t.fixRatio&&(a=t.fixRatio),"number"==typeof t.addRatio&&(a+=t.addRatio)),a<2?(i=(s.length-this.ip)/this.currentLitlenTable[2],n=i/2*258|0,r=n<o.length?o.length+n:o.length<<1):r=o.length*a,x?(e=new Uint8Array(r),e.set(o)):e=o,this.output=e,this.output},F.RawInflate.prototype.concatBuffer=function(){var t,e,i,r,n,a=0,s=this.totalpos+(this.op-F.RawInflate.MaxBackwardLength),o=this.output,f=this.blocks,h=new(x?Uint8Array:Array)(s);if(0===f.length)return x?this.output.subarray(F.RawInflate.MaxBackwardLength,this.op):this.output.slice(F.RawInflate.MaxBackwardLength,this.op);for(e=0,i=f.length;e<i;++e)for(t=f[e],r=0,n=t.length;r<n;++r)h[a++]=t[r];for(e=F.RawInflate.MaxBackwardLength,i=this.op;e<i;++e)h[a++]=o[e];return this.blocks=[],this.buffer=h,this.buffer},F.RawInflate.prototype.concatBufferDynamic=function(){var t,e=this.op;return x?this.resize?(t=new Uint8Array(e),t.set(this.output.subarray(0,e))):t=this.output.subarray(0,e):(this.output.length>e&&(this.output.length=e),t=this.output),this.buffer=t,this.buffer},F.RawInflate=function(t,e){switch(this.buffer,this.blocks=[],this.bufferSize=32768,this.totalpos=0,this.ip=0,this.bitsbuf=0,this.bitsbuflen=0,this.input=x?new Uint8Array(t):t,this.output,this.op,this.bfinal=!1,this.bufferType=F.RawInflate.BufferType.ADAPTIVE,this.resize=!1,this.prev,!e&&(e={})||(e.index&&(this.ip=e.index),e.bufferSize&&(this.bufferSize=e.bufferSize),e.bufferType&&(this.bufferType=e.bufferType),e.resize&&(this.resize=e.resize)),this.bufferType){case F.RawInflate.BufferType.BLOCK:this.op=F.RawInflate.MaxBackwardLength,this.output=new(x?Uint8Array:Array)(F.RawInflate.MaxBackwardLength+this.bufferSize+F.RawInflate.MaxCopyLength);break;case F.RawInflate.BufferType.ADAPTIVE:this.op=0,this.output=new(x?Uint8Array:Array)(this.bufferSize),this.expandBuffer=this.expandBufferAdaptive,this.concatBuffer=this.concatBufferDynamic,this.decodeHuffman=this.decodeHuffmanAdaptive}},F.RawInflate.BufferType={BLOCK:0,ADAPTIVE:1},F.RawInflate.prototype.decompress=function(){for(;!this.bfinal;)this.parseBlock();return this.concatBuffer()},F.RawInflate.MaxBackwardLength=32768,F.RawInflate.MaxCopyLength=258,F.RawInflate.Order=function(t){return x?new Uint16Array(t):t}([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),F.RawInflate.LengthCodeTable=function(t){return x?new Uint16Array(t):t}([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),F.RawInflate.LengthExtraTable=function(t){return x?new Uint8Array(t):t}([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),F.RawInflate.DistCodeTable=function(t){return x?new Uint16Array(t):t}([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),F.RawInflate.DistExtraTable=function(t){return x?new Uint8Array(t):t}([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),F.RawInflate.FixedLiteralLengthTable=function(t){return t}(function(){var t,e,i=new(x?Uint8Array:Array)(288);for(t=0,e=i.length;t<e;++t)i[t]=t<=143?8:t<=255?9:t<=279?7:8;return U(i)}()),F.RawInflate.FixedDistanceTable=function(t){return t}(function(){var t,e,i=new(x?Uint8Array:Array)(30);for(t=0,e=i.length;t<e;++t)i[t]=5;return U(i)}()),F.RawInflate.prototype.parseBlock=function(){var t=this.readBits(3);switch(1&t&&(this.bfinal=!0),t>>>=1){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw new Error("unknown BTYPE: "+t)}},F.RawInflate.prototype.readBits=function(t){for(var e,i=this.bitsbuf,r=this.bitsbuflen,n=this.input,a=this.ip,s=n.length;r<t;){if(a>=s)throw new Error("input buffer is broken");i|=n[a++]<<r,r+=8}return e=i&(1<<t)-1,i>>>=t,r-=t,this.bitsbuf=i,this.bitsbuflen=r,this.ip=a,e},F.RawInflate.prototype.readCodeByTable=function(t){for(var e,i,r=this.bitsbuf,n=this.bitsbuflen,a=this.input,s=this.ip,o=a.length,f=t[0],h=t[1];n<h&&!(s>=o);)r|=a[s++]<<n,n+=8;return e=f[r&(1<<h)-1],i=e>>>16,this.bitsbuf=r>>i,this.bitsbuflen=n-i,this.ip=s,65535&e},F.RawInflate.prototype.parseUncompressedBlock=function(){var t,e,i,r=this.input,n=this.ip,a=this.output,s=this.op,o=r.length,f=a.length;if(this.bitsbuf=0,this.bitsbuflen=0,n+1>=o)throw new Error("invalid uncompressed block header: LEN");if(t=r[n++]|r[n++]<<8,n+1>=o)throw new Error("invalid uncompressed block header: NLEN");if(e=r[n++]|r[n++]<<8,t===~e)throw new Error("invalid uncompressed block header: length verify");if(n+t>r.length)throw new Error("input buffer is broken");switch(this.bufferType){case F.RawInflate.BufferType.BLOCK:for(;s+t>a.length;){if(i=f-s,t-=i,x)a.set(r.subarray(n,n+i),s),s+=i,n+=i;else for(;i--;)a[s++]=r[n++];this.op=s,a=this.expandBuffer(),s=this.op}break;case F.RawInflate.BufferType.ADAPTIVE:for(;s+t>a.length;)a=this.expandBuffer({fixRatio:2});break;default:throw new Error("invalid inflate mode")}if(x)a.set(r.subarray(n,n+t),s),s+=t,n+=t;else for(;t--;)a[s++]=r[n++];this.ip=n,this.op=s,this.output=a},F.RawInflate.prototype.parseFixedHuffmanBlock=function(){this.decodeHuffman(F.RawInflate.FixedLiteralLengthTable,F.RawInflate.FixedDistanceTable)},F.RawInflate.prototype.parseDynamicHuffmanBlock=function(){function t(t,e,i){var r,n,a,s=this.prev;for(a=0;a<t;)switch(r=this.readCodeByTable(e)){case 16:for(n=3+this.readBits(2);n--;)i[a++]=s;break;case 17:for(n=3+this.readBits(3);n--;)i[a++]=0;s=0;break;case 18:for(n=11+this.readBits(7);n--;)i[a++]=0;s=0;break;default:i[a++]=r,s=r}return this.prev=s,i}var e,i,r,n,a=this.readBits(5)+257,s=this.readBits(5)+1,o=this.readBits(4)+4,f=new(x?Uint8Array:Array)(F.RawInflate.Order.length);for(n=0;n<o;++n)f[F.RawInflate.Order[n]]=this.readBits(3);if(!x)for(n=o,o=f.length;n<o;++n)f[F.RawInflate.Order[n]]=0;e=U(f),i=new(x?Uint8Array:Array)(a),r=new(x?Uint8Array:Array)(s),this.prev=0,this.decodeHuffman(U(t.call(this,a,e,i)),U(t.call(this,s,e,r)))},F.RawInflate.prototype.decodeHuffman=function(t,e){var i=this.output,r=this.op;this.currentLitlenTable=t;for(var n,a,s,o,f=i.length-F.RawInflate.MaxCopyLength;256!==(n=this.readCodeByTable(t));)if(n<256)r>=f&&(this.op=r,i=this.expandBuffer(),r=this.op),i[r++]=n;else for(a=n-257,o=F.RawInflate.LengthCodeTable[a],F.RawInflate.LengthExtraTable[a]>0&&(o+=this.readBits(F.RawInflate.LengthExtraTable[a])),n=this.readCodeByTable(e),s=F.RawInflate.DistCodeTable[n],F.RawInflate.DistExtraTable[n]>0&&(s+=this.readBits(F.RawInflate.DistExtraTable[n])),r>=f&&(this.op=r,i=this.expandBuffer(),r=this.op);o--;)i[r]=i[r++-s];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=r},F.RawInflate.prototype.decodeHuffmanAdaptive=function(t,e){var i=this.output,r=this.op;this.currentLitlenTable=t;for(var n,a,s,o,f=i.length;256!==(n=this.readCodeByTable(t));)if(n<256)r>=f&&(i=this.expandBuffer(),f=i.length),i[r++]=n;else for(a=n-257,o=F.RawInflate.LengthCodeTable[a],F.RawInflate.LengthExtraTable[a]>0&&(o+=this.readBits(F.RawInflate.LengthExtraTable[a])),n=this.readCodeByTable(e),s=F.RawInflate.DistCodeTable[n],F.RawInflate.DistExtraTable[n]>0&&(s+=this.readBits(F.RawInflate.DistExtraTable[n])),r+o>f&&(i=this.expandBuffer(),f=i.length);o--;)i[r]=i[r++-s];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=r},F.RawInflate.prototype.expandBuffer=function(t){var e,i,r=new(x?Uint8Array:Array)(this.op-F.RawInflate.MaxBackwardLength),n=this.op-F.RawInflate.MaxBackwardLength,a=this.output;if(x)r.set(a.subarray(F.RawInflate.MaxBackwardLength,r.length));else for(e=0,i=r.length;e<i;++e)r[e]=a[e+F.RawInflate.MaxBackwardLength];if(this.blocks.push(r),this.totalpos+=r.length,x)a.set(a.subarray(n,n+F.RawInflate.MaxBackwardLength));else for(e=0;e<F.RawInflate.MaxBackwardLength;++e)a[e]=a[n+e];return this.op=F.RawInflate.MaxBackwardLength,a},F.RawInflate.prototype.expandBufferAdaptive=function(t){var e,i,r,n,a=this.input.length/this.ip+1|0,s=this.input,o=this.output;return t&&("number"==typeof t.fixRatio&&(a=t.fixRatio),"number"==typeof t.addRatio&&(a+=t.addRatio)),a<2?(i=(s.length-this.ip)/this.currentLitlenTable[2],n=i/2*258|0,r=n<o.length?o.length+n:o.length<<1):r=o.length*a,x?(e=new Uint8Array(r),e.set(o)):e=o,this.output=e,this.output},F.RawInflate.prototype.concatBuffer=function(){var t,e,i,r,n,a=0,s=this.totalpos+(this.op-F.RawInflate.MaxBackwardLength),o=this.output,f=this.blocks,h=new(x?Uint8Array:Array)(s);if(0===f.length)return x?this.output.subarray(F.RawInflate.MaxBackwardLength,this.op):this.output.slice(F.RawInflate.MaxBackwardLength,this.op);for(e=0,i=f.length;e<i;++e)for(t=f[e],r=0,n=t.length;r<n;++r)h[a++]=t[r];for(e=F.RawInflate.MaxBackwardLength,i=this.op;e<i;++e)h[a++]=o[e];return this.blocks=[],this.buffer=h,this.buffer},F.RawInflate.prototype.concatBufferDynamic=function(){var t,e=this.op;return x?this.resize?(t=new Uint8Array(e),t.set(this.output.subarray(0,e))):t=this.output.subarray(0,e):(this.output.length>e&&(this.output.length=e),t=this.output),this.buffer=t,this.buffer},!window.btoa){var M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);window.btoa=function(t){var e,i,r,n,a,s;for(r=t.length,i=0,e="";r>i;){if(n=255&t.charCodeAt(i++),i==r){e+=M.charAt(n>>2),e+=M.charAt((3&n)<<4),e+="==";break}if(a=t.charCodeAt(i++),i==r){e+=M.charAt(n>>2),e+=M.charAt((3&n)<<4|(240&a)>>4),e+=M.charAt((15&a)<<2),e+="=";break}s=t.charCodeAt(i++),e+=M.charAt(n>>2),e+=M.charAt((3&n)<<4|(240&a)>>4),e+=M.charAt((15&a)<<2|(192&s)>>6),e+=M.charAt(63&s)}return e},window.atob=function(t){var e,i,r,n,a,s,o;for(s=t.length,a=0,o="";s>a;){do{e=P[255&t.charCodeAt(a++)]}while(s>a&&-1==e);if(-1==e)break;do{i=P[255&t.charCodeAt(a++)]}while(s>a&&-1==i);if(-1==i)break;o+=String.fromCharCode(e<<2|(48&i)>>4);do{if(61==(r=255&t.charCodeAt(a++)))return o;r=P[r]}while(s>a&&-1==r);if(-1==r)break;o+=String.fromCharCode((15&i)<<4|(60&r)>>2);do{if(61==(n=255&t.charCodeAt(a++)))return o;n=P[n]}while(s>a&&-1==n);if(-1==n)break;o+=String.fromCharCode((3&r)<<6|n)}return o}}k.b64EncodeUnicode=function(t){return btoa(e.enc(t).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode("0x"+e)}))},k.b64DecodeUnicode=function(t){return decodeURIComponent(Array.prototype.map.call(atob(t).split(""),function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""))},k.Async=function(t,e,i){this.isParallel=!!t,this._queue=[],this.success=e,this.fail=i,this.isPending=!0},k.Async.prototype.enqueue=function(t){this._queue.push({fn:t,resolved:!1}),(this.isParallel||1==this._queue.length)&&t.apply(this,[{resolve:e.proxy(function(){e.nextTick(e.proxy(function(){this.ctx.resolve(this.cb)},this))},{cb:t,ctx:this}),error:e.proxy(function(){this.ctx.error(this.cb)},{cb:t,ctx:this})}])},k.Async.prototype.resolve=function(t){if(this.isPending){if(!t)throw new Error("Missing caller argument.");var i,r,n=!1;for(i=0;i<this._queue.length;i++)r=this._queue[i],r.fn===t?r.resolved=!0:r.resolved||(n=!0);if(!this.isParallel&&n){var a;for(i=0;i<this._queue.length;i++)if(r=this._queue[i],!1===r.resolved){a=r;break}if(a)return void a.fn.apply(this,[{resolve:e.proxy(function(){this.ctx.resolve(this.cb)},{cb:a.fn,ctx:this}),error:e.proxy(function(){this.ctx.error(this.cb)},{cb:a.fn,ctx:this})}])}n||(this.isPending=!1,this.success.call(this))}},k.Async.prototype.error=function(){this.isPending=!1,this.fail&&this.fail.call(this)},k.imgInfo=function(t,i){var r=function(){};i=i||r;var n=new Image;n.onload=function(){i(n.width,n.height)},n.onerror=function(){},t.indexOf("//")>-1?n.src=t:n.src=e.makeURI("$"+t),n.width&&(n.onload=n.onerror=r,i(n.width,n.height))},k.getHashParm=function(t){var i=window.location.hash.toString();if(i&&i.length>0)for(var r=i.split("&"),n=0;n<r.length;n++){var a=r[n].split("="),s=e.toLowerCase(a[0]).trim();if(s==e.toLowerCase(t)){if(a.length>1)return decodeURIComponent(a[1]);break}}},k.compile=function(t){var e,i=[].constructor.constructor;return delete[].constructor.constructor,e=new[].constructor.constructor("var v = ''; try { v = "+t+"} catch(err) {}return v;"),[].constructor.constructor=i,e.call(window)},k.retrieveNestedVariable=function(t,e){for(var i=t||window,r=e.split("."),n=0;n<r.length&&i;)i=i[r[n++]];return void 0!==i&&n===r.length?i:void 0},k.generateGUID=function(){return k.md5(k.now()+""+navigator.userAgent+window.location+(new Date).getTimezoneOffset()+Math.random())},k.Journey=function(t,i,r,n,a){this.threshold=a||400,this.browser=n,e.isString(i)||(i=""),this.cors=new k.AjaxTransport,this.url=e.config.analyticsUrl.replace(/^https?:/i,location.protocol),this.data={customerId:t,appId:i,userId:r||"0000-0000-0000-0000-0000",deviceProfile:{fs_os:n.os.name,fs_osVersion:n.os.version,fs_sdkVersion:e.config.codeVer,fs_browserName:n.browser.name,fs_browserVersion:n.browser.version,fs_type:n.isMobile?"Mobile":n.isTablet?"Tablet":"Desktop",fs_productType:"web sdk"},events:[]},this.eventsDefault={properties:{fs_pageUrl:[location.href]}}},k.Journey.prototype._send=function(){this._svT=null,this.data.events.length>0&&k.Healthy(this.browser,["events"],e.proxy(function(){this.cors.send({url:this.url,contentType:"application/json",headers:{"Request-API-Version":"1.0.0"},data:this.data,method:"POST",success:e.proxy(function(){this.data.events=[]},this)})},this))},k.Journey.prototype.addEventsDefault=function(t,i){if(!t||["properties","metrics","data"].indexOf(t)<0)return this.eventsDefault;if(!H(t,i))return this.eventsDefault;for(var r in i)i.hasOwnProperty(r)&&Array.isArray(i[r])&&i[r].length>0&&(i[r]=i[r].filter(e.isDefined),i[r].length<1&&delete i[r]);return this.eventsDefault=this.eventsDefault||{},this.eventsDefault[t]=e.ext(this.eventsDefault[t],i),this.eventsDefault},k.Journey.prototype.setKey=function(t,i){return!!e.isObject(i)&&(this.data[t]=i,this.data.events.length||this.addEventString("fs_setKey"),!0)},k.Journey.prototype.addEvent=function(t){var e=typeof t;switch(e){case"string":this.addEventString(t);break;case"object":this.addEventObj(t);break;default:console.error("ForeSee: event is not a valid type: ",e)}},k.Journey.prototype.addEventObj=function(t){if(t.timestamp||(t.timestamp=(new Date).toISOString()),t.timezone||(t.timezone=(new Date).getTimezoneOffset()),!(t.name&&t.name.length>0&&H("properties",t.properties)&&H("metrics",t.metrics)&&H("data",t.data)))return void console.error("ForeSee: Invalid Event. For proper usage, please refer to http://developer.foresee.com/docs-articles/foresee-hosted-code/calling-api-methods/event-logging/");t=j(t,this.eventsDefault),this.data.events.push(t),z(this)};var j=function(t,i){return["properties","metrics","data"].reduce(function(t,r){return i[r]&&(t[r]=e.ext(t[r],i[r])),t},t)};k.Journey.prototype.addEventString=function(t){this.data.events.push(j({name:t,timestamp:(new Date).toISOString(),timezone:(new Date).getTimezoneOffset()},this.eventsDefault)),z(this)};var z=function(t,i){i?t._send(!0):t._svT||(t._svT=setTimeout(e.proxy(function(){t._send(!0)},t),t.threshold))},H=function(t,e){var i;switch(t){case"properties":if(e)for(i in e)if(!Array.isArray(e[i]))return console.error("ForeSee: Invalid properties"),!1;break;case"metrics":if(e)for(i in e)if(!k.isNumeric(e[i]))return console.error("ForeSee: Invalid metrics"),!1}return!0};k.dedupe=function(t){var e,i;for(e=t.length-1;e>=0;e--)for(i=e-1;i>=0;i--)t[i]==t[e]&&t.splice(e,1);return t},k.arrayIndexOf=function(t,e){for(var i in e)if(e[i]===t)return i;return-1},k.inArray=function(t,e){return-1!=k.arrayIndexOf(t,e)},k.DomStorage=function(t,i,r,n){this.isLocal=!!r,t||(t="STORAGE"),this.guid="FSR_"+t.replace(/[- _.&]/g,"").toUpperCase(),this.StorageFull=new k.FSEvent,this.storageLimit=45e5,this.kill(),this.sync(),e.isDefined(i)&&!i||setTimeout(e.proxy(function(){k.Bind(window,"unload",e.proxy(function(){this.commit()},this))},this),100)},k.DomStorage.prototype.testStorageLimit=function(){return this.storageBytesObj+this.storageBytesBlob>=this.storageLimit&&(this.StorageFull.fire(this),!0)},k.DomStorage.prototype.dispose=function(t){this._data_obj[t]&&(delete this._data_obj[t],this.storageBytesObj=JSON.stringify(this._data_obj).length)},k.DomStorage.prototype.kill=function(){this.storageBytesObj=0,this.storageBytesBlob=0,this._data_obj={},this._data_blob="",this.isNewStorage=!0},k.DomStorage.prototype.get=function(t){return this._data_obj[t]},k.DomStorage.prototype.getBlob=function(){return this._data_blob},k.DomStorage.prototype.erase=function(t){delete this._data_obj[t],this.storageBytesObj=JSON.stringify(this._data_obj).length,this.isNewStorage=!1,this.testStorageLimit()},k.DomStorage.prototype.set=function(t,e){e&&(this._data_obj[t]=e,this.storageBytesObj=JSON.stringify(this._data_obj).length,this.isNewStorage=!1,this.testStorageLimit())},k.DomStorage.prototype.setBlob=function(t){this._data_blob=t,this.storageBytesBlob=this._data_blob.length,this.isNewStorage=!1,this.testStorageLimit()},k.DomStorage.prototype.isNew=function(){var t;return window.opener&&!this.get("isNew")&&(t=!0,this.set("isNew",t)),t||this.isNewStorage},k.DomStorage.initialize=function(t){t.apply(k.DomStorage)},k.DomStorage.isSupported=function(){return!!localStorage},k.DomStorage.prototype.sync=function(){var t;try{t=localStorage.getObject(this.guid+"_OBJ"),t&&t.length>0&&(this._data_obj=JSON.parse(t),this.storageBytesObj=t.length,this.isNewStorage=!1)}catch(t){}try{t=localStorage.getObject(this.guid+"_BLOB"),t&&t.length>0&&(this._data_blob=t,this.storageBytesBlob=t.length,this.isNewStorage=!1)}catch(t){}},
k.DomStorage.prototype.commit=function(){try{localStorage.setItem(this.guid+"_OBJ",JSON.stringify(this._data_obj)),localStorage.setItem(this.guid+"_BLOB",this._data_blob)}catch(t){}};var W={},J=0;k.loadCSS=function(t,e,i,r){if(!r)throw new Error("loadCSS missing browser instance");var n=W[t];if(n){if(n.link.parentElement)return n.success.subscribe(e||function(){},!0,!0),n.fail.subscribe(i||function(){},!0,!0),n.link;delete W[t]}var a,s,o=!1;J++,a="fs-css-"+J,s=document.createElement("link"),s.setAttribute("id",a),s.setAttribute("rel","stylesheet"),s.setAttribute("type","text/css");var f={link:s,url:t,didfail:!1,didsucceed:!1,success:new k.FSEvent,fail:new k.FSEvent};f.success.subscribe(e,!0,!0),f.fail.subscribe(i,!0,!0),W[t]=f,s.addEventListener("load",function(){o=!0,f.didsucceed=!0,f.success.fire(s)},!1),s.addEventListener("error",function(){f.didfail=!0,f.fail.fire(s)},!1);var h=document.documentElement,u=document.getElementsByTagName("head");return u&&u.length>0&&(h=u[0]),h.appendChild(s),s.setAttribute("href",t),s},e.nextTick=function(t){setTimeout(t||function(){},0)},k.randomRange=function(t,e){return t+Math.random()*(e-t)},k.isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},k.products={},k.productArr=[],k.registerProduct=function(t,e){e=e||{},k.products[t]=e,k.productArr.push(t)},k.Browser=function(t){var i=this,r=t||navigator.userAgent,n=e.toLowerCase(r);e.ext(i,{agent:r,os:{name:"",version:0},browser:{name:"",version:0,actualVersion:0},isMobile:/iphone|ipad|ipod|android|kindle|silk|bntv|nook|blackberry|playbook|mini|windows\sce|windows\sphone|palm|bb10/i.test(r)||!!window.orientation,isTablet:/ipad|playbook|nook|bntv/i.test(r),isWinPhone:/Windows Phone/i.test(r),fp:"",supportsLocalStorage:!1,supportsPostMessage:!!window.postMessage,isIE:!1,isZoomable:!0,supportsSVG:document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),isReady:!1,ready:new k.FSEvent,_internalReady:new k.FSEvent,isIos:!1,servUrl:location.protocol+"//device.4seeresults.com/detect?accessToken="});try{localStorage&&(localStorage.setItem("a","b"),localStorage.removeItem("a"),i.supportsLocalStorage=!0)}catch(t){}i._internalReady.subscribe(function(){i.fp=new C(i),i.fp.ready.subscribe(function(){i.fp=i.fp.sig,i.ready.fire(i)},!0,!0)}),i.isMobile&&/iphone|ipad|ipod/i.test(r)&&!i.isWinPhone&&(i.isIos=!0);var a=function(t){return n.indexOf(e.toLowerCase(t))>-1},s=function(t,e){return"IE"!=t?e:e>6&&e<10?a("Trident")||7!=e?a("Trident/5.0")&&e<=9?9:a("Trident/4.0")&&e<9?a("WOW64")?8:7==e?e:8:e:7:e},o=function(t,i){return i?a("Windows Phone")?"Winphone":a("iPod")?"iPod":a("iPad")?"iPad":a("iPhone")?"iPhone":(a("blackberry")||a("playbook")||a("BB10"))&&a("applewebkit")?"Blackberry":a("Kindle")||a("Silk")?"Kindle":a("BNTV")||a("Nook")?"Nook":a("Android")?"Android":e.isDefined(window.orientation)?"Mobile":"Other":a("Windows")?"Windows":a("OS X")?"Mac":a("Linux")||a("Googlebot")?"Linux":a("Mac")?"Mac":void 0},f=function(t,e){for(;t>=e;)t/=10;return t},h=function(t,i){var r,n,s,o,h,u;return a("windows phone")||!a("ipad")&&!a("iphone")?a("googlebot")?1:a("mac os x")?(r=/OS X ([0-9_]*)/gi.exec(t),n=r[1].split("_"),s=parseInt(n[0]),h=parseInt(n[1]),u=parseInt(n[2]),h+=f(u,1),s+f(h,1)):a("Windows NT")?(r=/Windows NT ([0-9\.]*)/gi.exec(t),n=r[1].split("."),s=parseInt(n[0]),h=parseInt(n[1]),s+f(h,1)):(r=t.match(/Windows Phone OS[\/\s](\d+\.?\d+)/)||t.match(/Windows Phone[\/\s](\d+\.?\d+)/)||t.match(/Android[\/\s](\d+\.?\d+)/),s=e.isDefined(r)?r[1]:1,o=parseFloat(s),!isNaN(o)&&o>0?o:s):(r=/OS ([0-9_]*) like/gi.exec(t),n=r[1].split("_"),s=parseInt(n[0]),h=parseInt(n[1]),s+f(h,1))},u=function(){if("Winphone"!=i.os.name){var t=document.querySelectorAll("head meta[name=viewport],head meta[name=VIEWPORT],head meta[name=Viewport]")||[];if(Array.isArray(t)||(t=[t]),t.length>0){for(var r=function(t,e){var i=new RegExp("[\\w\\W]*"+e+"[\\s]*=[\\s]*([^\\s,;]*)[\\w\\W]*","i");return t?t.match(i):null},n=0;n<t.length;n++){var a=t[n].content,s=r(a,"user-scalable"),o=r(a,"initial-scale"),f=r(a,"maximum-scale");if(s&&s.length>1&&("0"==s[1]||"no"==e.toLowerCase(s[1])))return!1;if(o&&f)return!(o.length>1&&f.length>1&&1==parseFloat(o[1])&&1==parseFloat(f[1]))}return!0}return!0}return!1},l=k._getBrowserNameAndVersion(r),c=function(){i.browser.name=l.name,i.browser.version=l.version,i.browser.actualVersion=s(i.browser.name,i.browser.version),i.os.name=o(0,i.isMobile),i.os.version=h(r,i.isMobile)},d=function(){i.isZoomable=u(),i.isReady=!0,i._internalReady.fire()},p=function(){c()};if(i.isMobile)if(i.isIos||""===i.servUrl||i.isTablet||i.isWinPhone)p(),d();else{var g,y=function(t){var e=JSON.parse(t);i.browser.name=e.browser.name,i.browser.version=i.browser.actualVersion=e.browser.version,i.os.name=e.os.name,i.os.version=e.os.version,i.isMobile=e.isMobile,i.isTablet=e.isTablet,d()},b=this.supportsLocalStorage;if(b&&!t&&(g=sessionStorage.getItem("ACS_BROWSER")),g)y(g);else{var w=function(t){b&&sessionStorage.setItem("ACS_BROWSER",t),y(t)},v=function(){p(),d()},m=function(){var t=new Date,e=t.getFullYear().toString(),i=(t.getMonth()+1).toString(),r=t.getDate().toString();return e+(i[1]?i:"0"+i[0])+(r[1]?r:"0"+r[0])},S={method:"GET",url:i.servUrl+function(){var t=m()+"ForeSee"+(location.origin||"null");return k.hashCode(t)}()+"&ua="+r,type:"*/*",contentType:"application/x-www-form-urlencoded",success:w,failure:v};new k.AjaxTransport(S,!0).send()}}else c(),i.isReady=!0,i.isIE="IE"==i.browser.name,i._internalReady.fire()},k.getBrowserInstance=function(){function t(){return e||(e=new k.Browser)}var e;return t}(),k._getBrowserNameAndVersion=function(t){var e,i,r="Unknown";return null!==(i=t.match(/Opera[\/\s](\d+\.\d+)/))?r="Opera":null!==(i=t.match(/Edge\/([0-9\.]*)/))?r="IE":null!==(i=t.match(/opr[\/\s](\d+\.\d+)/i))?r="Opera":null!==(i=t.match(/Windows Phone[\/\s](\d+\.\d+)/))?r="IEMobile":null!==(i=t.match(/MSIE (\d+\.\d+)/))?r="IE":null!==(i=t.match(/Navigator[\/\s](\d+\.\d+)/))?r="Netscape":null!==(i=t.match(/Chrome[\/\s](\d+\.\d+)/))?r="Chrome":null!==(i=t.match(/CriOS[\/\s](\d+\.\d+)/))?r="Chrome":null!==(i=t.match(/Version\/([0-9\.]*)[\w\W]*Safari/i))?r="Safari":null!==(i=t.match(/Firefox[\/\s](\d+\.\d+)/))?r="Firefox":null!==(i=t.match(/googlebot/gi))?(r="Chrome",e=44):Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject&&(r="IE",e=11),{name:r,version:e||(null!==i?parseFloat(i[1]):void 0)}};var K={_id:"",has:function(){try{return!!(window.s&&e.isFunction(s.c_r)&&s.c_r("s_vi").indexOf("[CE]")>-1)}catch(t){return!1}},intervals:{uid:"",mcid:""},sgi:function(t){return!(!t||"undefined"==typeof s_gi||!s_gi)&&(Array.isArray(t)&&2===t.length&&(t=t.join(",")),s_gi(t))},uid:function(t,e){var i,r,n=0;clearInterval(this.intervals.uid),this.intervals.uid=setInterval(function(){i=this.sgi(t),n++<10&&i?(i.visitorID?r={name:"OMTR_VID",value:i.visitorID}:i.analyticsVisitorID?r={name:"OMTR_VID",value:i.analyticsVisitorID}:i.fid&&(r={name:"OMTR_FID",value:i.fid}),r&&(e(r),clearInterval(this.intervals.uid))):clearInterval(this.intervals.uid)}.bind(this),1e3)},mcid:function(t,e){var i,r,n=0;clearInterval(this.intervals.mcid),this.intervals.mcid=setInterval(function(){i=this.sgi(t),n++<10&&i?(i.marketingCloudVisitorID&&(r={name:"OMTR_MCID",value:i.marketingCloudVisitorID}),r&&(e(r),clearInterval(this.intervals.mcid))):clearInterval(this.intervals.mcid)}.bind(this),1e3)},beacon:function(){function t(t,e){for(var i="",r=e.split("&"),n=0;n<r.length;n++)for(var a=r[n].split("="),s=0;s<t.length;s++)if(t[s]==a[0]){i+=a[0]+"="+a[1]+"&";break}return"&"==i.substr(i.length-1)&&(i=i.substr(0,i.length-1)),i}if(K._id)return K._id;var i,r,n,a,o=["AQB","mid","aid","vid","fid","AQE"],f="";for(var h in window)if("s_i_"==h.substring(0,4)&&window[h].src&&(i=window[h].src,i.indexOf("/b/ss/")>=0)){f=i;break}if(!f&&window.s_c_il&&window.s_c_il[0]&&window.s_c_il[0].eb&&(f=window.s_c_il[0].eb),!f&&window.document.images)for(var u=0;u<window.document.images.length;u++)if(i=window.document.images[u].src,i.indexOf("/b/ss/")>=0){f=i;break}if(f&&e.isString(f)){r=f.substring(0,f.indexOf("?")),n=f.substring(f.indexOf("?")+1),a=t(o,n),window.s&&s.trackingServerSecure&&(r="https://"+s.trackingServerSecure+f.substring(f.indexOf("/b/ss/"),f.indexOf("?")),n=f.substring(f.indexOf("?")+1),a=t(o,n));var l=r+"?"+a;return l.length<3?l=null:K._id=l,l}}};k.INT.OM=K;var V={has:function(){var t=window.ga;return"function"==typeof t&&t.getAll&&t.getAll().length},uid:function(t){var i=e.nextTick;V.has()?ga(function(e){i(function(){if(e)t(e.get("clientId"));else try{t(ga.getAll()[0].get("clientId"))}catch(e){t()}})}):i(function(){t()})}};k.INT.GA=V;var G={byteArrayToString:function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e},stringToByteArray:function(t){for(var e=[],i=0;i<t.length;i++)e[e.length]=t.charCodeAt(i);return e},_utf8_encode:function(t){for(var e="",i=0;i<t.length;i++){var r=t.charCodeAt(i);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e},compress:function(t,i){e.isFunction(i)||(i=G._utf8_encode);var r=i(t),n=G.stringToByteArray(r),a=new F.RawDeflate(n,{compressionType:2}).compress();return btoa(G.byteArrayToString(a))},fragmentAndCompress:function(t,e){e=e||1e5;for(var i="",r=parseInt(t.length/e)+1,n=0;n<r;n++){i+="_CMP_"+G.compress(t.substring(n*e,(n+1)*e))}return i},decompress:function(t,i){var r=G.stringToByteArray(atob(t)),n=new F.RawInflate(r,{index:0,bufferSize:41152,bufferType:F.RawInflate.BufferType.ADAPTIVE,resize:!0}),a=G.byteArrayToString(n.decompress());return e.isFunction(i)&&(a=i(a)),a}};k.Compress=G,k.addClass=function(t,i){var r,n,a,s;for(e.isDefined(t.length)||(t=[t]),r=0,n=t.length;r<n;r++)a=t[r],k.isElement(a)&&(s=a.className||"",new RegExp("\\b"+i+"\\b").test(s)||(a.className=(""===s?"":s+" ")+i))},k.removeClass=function(t,i){var r,n,a;for(e.isDefined(t.length)||(t=[t]),r=0,n=t.length;r<n;r++)a=t[r],k.isElement(a)&&a.className&&(a.className=a.className.replace(new RegExp("(\\s|^)"+i+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))},k.hasClass=function(t,e){return k.isElement(t)&&t.classList&&t.classList.contains(e)},k.css=function(t,i,r){if(t){e.isDefined(t.length)||(t=[t]);for(var n=0;n<t.length;n++)for(var a in i)a&&(-1=="zIndex".indexOf(a)&&"number"==typeof i[a]&&"opacity"!=a&&(i[a]+="px"),r?t[n].style.cssText+=";"+a+":"+i[a]+" !important":t[n].style[a]=i[a])}return t},k.attr=function(t,i){if(t){e.isDefined(t.length)||(t=[t]);for(var r=0;r<t.length;r++)for(var n in i)t[r].setAttribute(n,i[n])}return t},k.restrictFocus=function(t){for(var e=document.querySelectorAll("a, input[type=text], textarea, button, input[type=radio], select, *[tabIndex]",t).sort(function(t,e){return parseInt(t.tabIndex)>parseInt(e.tabIndex)}),i=0;i<e.length;i++){var r=e[i];k.Unbind(r,"keydown"),k.Bind(r,"keydown",function(t){return function(e){var i,r;if(9===e.keyCode)for(i=0;i<t.length;i++)if(t[i]===e.target){if(e.preventDefault?e.preventDefault():e.returnValue=!1,r=i,e.shiftKey)do{r=0===r?t.length-1:r-1}while((t[r].offsetLeft<=0||t[r].tabIndex<0)&&r!=i);else do{r=(r+1)%t.length}while((t[r].offsetLeft<=0||t[r].tabIndex<0)&&r!=i);t[r].focus();break}}}(e))}},k.hideAll=function(t){var e,i=document.body.querySelectorAll("*");for(e=0;e<i.length;e++)k.css(i[e],{display:"none"})},k.elindex=function(t){for(var e,i=t.parentNode.childNodes,r=0,n=0;(e=i.item(r++))&&e!=t;)1==e.nodeType&&n++;return n},k.isElement=function(t){return t&&t.nodeType&&(1==t.nodeType||11==t.nodeType||9==t.nodeType)};var q,X,Y=function(t,i,r){for(var n=[],a=[],s=[],o=0;o<t.length;o++){var f=q.info[t[o]];f&&!0!==f.up?s.push(t[o]):(n.push(e.ext({},f)),a.push(t[o]))}s.length>0?r(s):i(n)};return k.Healthy=function(t,i,r,n){if (localStorage) { var nwval = (new Date).getTime(); try { localStorage.setItem("_fsrHealthStatus", JSON.stringify({ last: nwval, info: { survey2: { ref: { rel: "content", url: "https://cx.foresee.com/status" }, up: true, last_check: nwval, latency: 0 }, survey: { ref: { rel: "content", url: "https://survey.foreseeresults.com/survey/status" }, up: true, last_check: nwval, latency: 87 }, cxreplay: { ref: { rel: "content", url: "https://rec.replay.answerscloud.com/status" }, up: true, last_check: nwval, latency: 77 }, events: { ref: { rel: "content", url: "https://analytics.foresee.com/status" }, up: true, last_check: nwval, latency: 70 }, trust: { ref: { rel: "status", url: "" }, up: false }, brain: { ref: { rel: "content", url: "https://brain.foresee.com/status" }, up: true, last_check: nwval, latency: 348 }, static: { ref: { rel: "content", url: "https://static.foresee.com" }, up: true, last_check: nwval, latency: 74 }, device: { ref: { rel: "content", url: "https://device.4seeresults.com/status" }, up: true, last_check: nwval, latency: 68 } } })) } catch (e) { } }if(Array.isArray(i)||(i=[i]),r=r||function(){},n=n||function(){},!q&&t.supportsLocalStorage){var a=localStorage.getItem("_fsrHealthStatus");q=a?JSON.parse(a):{}}q&&q.last&&k.now()-q.last<2592000000?e.nextTick(function(){Y(i,r,n)}):(X||(X=new k.AjaxTransport),X.send({method:"GET",url:location.protocol+"//health.foresee.com",timeout:1e4,failure:e.proxy(function(){n(i)},this),success:e.proxy(function(r){e.isString(r)&&r.length>3?(q={last:k.now(),info:JSON.parse(r)},t.supportsLocalStorage&&localStorage.setItem("_fsrHealthStatus",JSON.stringify(q)),Y(i,this.s,this.f)):n(i)},{deps:i,s:r,f:n})}))},k.HealthStatus=function(t,i,r){var n=function(t,i){return function(){for(var i={},n=0;n<t.length;n++){var a={up:!1};q&&q.info&&q.info[t[n]]&&(a=e.ext({},q.info[t[n]])),i[t[n]]=a}r(i)}}(i);k.Healthy(t,i,n,n)},k.ImageTransport=function(t){var i={data:{},success:function(){},failure:function(){}};this.options=e.ext(i,t)},k.ImageTransport.prototype.send=function(t){var i=e.ext(this.options,t),r=new Image;r.onerror=i.failure,r.onload=function(){i.success({width:r.width,height:r.height})},r.src=e.toQueryString(i.data,i.url,!1)},window.__fsJSONPCBr={},window.__fsJSONPCB=e.proxy(function(t){if(t){var e=t.filename,i=atob(t.contents);window.__fsJSONPCBr[e]&&window.__fsJSONPCBr[e].fire(i)}},this),k.JSONP=function(t){this._expireTimeout=null,this._networkError=new k.FSEvent,this.opts=e.ext({success:function(){},failure:function(){},timeout:5e3},t)},k.JSONP.prototype.get=function(t,i){var r=t.indexOf("?")>-1?t.substr(t.indexOf("?")+1):"",n=t.substr(0,t.lastIndexOf("/")+1),a=t.substr(t.lastIndexOf("/")+1),s=window.__fsJSONPCBr;this._expireTimeout=setTimeout(e.proxy(function(){this._networkError.fire({type:"timedout"})},this),this.opts.timeout),a.indexOf("?")>-1&&(a=a.substr(0,a.indexOf("?")));var o=(i||"")+a;if(!s[o]){s[o]=new k.FSEvent;var f=n+a.substr(0,a.lastIndexOf("."))+"___"+a.substr(a.lastIndexOf(".")+1)+".js"+(r.length>0?"?"+r:""),h=new N(f,"_fscl"+o);h.loadFailure.subscribe(e.proxy(function(){this.el.parentNode.removeChild(this.el),this.ctx._networkError.fire({type:"internalserror"})},{ctx:this,el:h.st}))}s[o].subscribe(e.proxy(function(t){this.ctx.opts.success(t),clearTimeout(this.ctx._expireTimeout);var e=document.getElementById(this.tgId);e&&e.parentNode.removeChild(e)},{ctx:this,tgId:"_fscl"+o}),!0,!0),this._networkError.subscribe(e.proxy(function(t){this.opts.failure(t),s[o].unsubscribeAll()},this),!0,!0)},k.sign=function(t){var i=(new Date).getTime(),r=t.substr(t.indexOf("/rec/")),n=k.md5((r+i).toString());return-1==t.indexOf("?")?t+="?":t+="&",t+"token="+i+"&sig="+e.enc(n)},k.Cookie=function(t){this.opts=t||{}},k.Cookie.prototype.set=function(t,i,r){var n,a=this.opts;r&&(a=e.ext({},a,r)),i=e.isDefined(a.encode)?e.enc(i):i,t=e.enc(t),"localhost"==a.domain&&delete a.domain,e.config.cookieSecure&&"false"!==e.config.cookieSecure&&"false"!==e.hasSSL&&(i+=";secure");for(var s in a)if(a[s])switch(n=a[s],i+=";"+("duration"==s?"expires":s),s){case"expires":i+="="+(e.isDate(n)?n.toUTCString():n)+";";break;case"duration":i+="="+new Date(k.now()+n*k.FULL_DAY).toUTCString()+";";break;default:i+="="+n}document.cookie=t+"="+i},k.Cookie.prototype.get=function(t){var e=document.cookie.match("(?:^|;)\\s*"+k.escapeRegExp(t)+"=([^;]*)");return e?decodeURIComponent(e[1]):null},k.Cookie.prototype.kill=function(t){var e=new Date;e.setTime(e.getTime()-9999),this.set(t,"",{expires:e.toUTCString()})},k.CPPS=function(t,e){this.gs=t,this.onSet=new k.FSEvent,this._blCPP=[],this.exp=e||864e5},k.CPPS.prototype={addToBlacklist:function(t){t=t||[];var e=this.all();this._blCPP=this._blCPP.concat(t);for(var i=0;i<t.length;i++)delete e[t[i]];this.gs.set("cp",e)},set:function(t,e){if(-1==this._blCPP.indexOf(t)){var i=this.all();i[t]=e+"",this.gs.set("cp",i,this.exp),this.onSet.fire(t,e)}},get:function(t){return this.all()[t]},all:function(){return this.gs.get("cp")||{}},toQueryString:function(){var t=[],i=this.all();for(var r in i)t.push("cpp["+e.enc(r)+"]="+e.enc(i[r]));return t.join("&")},erase:function(t){var e=this.all();delete e[t],this.gs.set("cp",e)},save:function(){this.gs.save()},append:function(t,e,i){var r,n,a,s=this.gs.get("cp")||{};-1==this._blCPP.indexOf(t)&&(s[t]=(s[t]||"")+","+e,i&&(r=s[t].split(","),n=r.length-1,a=r.length>i?r.length-i:0,s[t]=r.splice(a,n-a+1).join()),this.gs.set("cp",s))}},k.defaultConfigs={global:{storage:"COOKIE",alwaysOnLatest:1,cookieSecure:!1,deferredLoading:!1,products:{trigger:!1,feedback:!1,record:!1}},survey:{devices:{overridesEnabled:!0,desktop:{icon:"aspark100.png",fbtype:"badge",surveytype:"popup",disabled:!0,size:"medium",fbsize:"medium"},mobile:{icon:"aspark100.png",fbtype:"badge",surveytype:"popup",disabled:!0,size:"medium",fbsize:"medium"},tablet:{icon:"aspark100.png",fbtype:"badge",surveytype:"popup",popup:!0,disabled:!0,fbsize:"medium",size:"medium",fbdirection:"horizontal",fblocation:"middleleft"}},icon:"aspark100.png",delay:0,template:"default",fblocation:"bottomleft",fbtype:"badge",disabled:!1,fbanimate:!1,fbfixed:!0,fbdirection:"horizontal",surveytype:"popup",replay:!0,fbcolor:"#f1c40f",isExistingSurveyDisabled:!0,saved:!0,whitelistActive:!1,blacklistActive:!1,whitelistData:[],blacklistData:[]}},k.WindowStorage=function(t,i){t||(t="STORAGE"),this.guid="FSR_"+t.replace(/[- _.&]/g,"").toUpperCase(),this.storageLimit=5e6,this.StorageFull=new k.FSEvent,this.kill(),this.sync(),e.isDefined(i)&&!i||setTimeout(e.proxy(function(){k.Bind(window,"unload",e.proxy(function(){this.commit()},this))},this),100)},k.WindowStorage.prototype.testStorageLimit=function(){return this.storageBytesObj+this.storageBytesBlob>=this.storageLimit&&(this.StorageFull.fire(this),!0)},k.WindowStorage.prototype.dispose=function(t){this._data_obj[t]&&(delete this._data_obj[t],this.storageBytesObj=JSON.stringify(this._data_obj).length)},k.WindowStorage.prototype.kill=function(){this.storageBytesObj=0,this.storageBytesBlob=0,this._data_obj={},this._data_blob="",this.isNewStorage=!0},k.WindowStorage.prototype.get=function(t){return this._data_obj[t]},k.WindowStorage.prototype.getBlob=function(){return this._data_blob},k.WindowStorage.prototype.erase=function(t){delete this._data_obj[t],this.storageBytesObj=JSON.stringify(this._data_obj).length,this.isNewStorage=!1,this.testStorageLimit()},k.WindowStorage.prototype.set=function(t,e){e&&(this._data_obj[t]=e,this.storageBytesObj=JSON.stringify(this._data_obj).length,this.isNewStorage=!1,this.testStorageLimit())},k.WindowStorage.prototype.setBlob=function(t){this._data_blob=t,this.storageBytesBlob=this._data_blob.length,this.isNewStorage=!1,this.testStorageLimit()},k.WindowStorage.prototype.isNew=function(){return this.isNewStorage},k.WindowStorage.initialize=function(t){t.apply(k.WindowStorage)},k.WindowStorage.isSupported=function(){return!0},k.WindowStorage.prototype.sync=function(){var t=k.nameBackup||window.name||"",e=this.guid+"_",i="",r=t.indexOf(e+"BEGIN_OBJ");r>-1&&(i=t.substr(r+(e+"BEGIN_OBJ").length,t.indexOf(e+"END_OBJ")-(r+(e+"BEGIN_OBJ").length)));try{i.length>0&&(this._data_obj=JSON.parse(i),this.storageBytesObj=i.length,this.isNewStorage=!1)}catch(t){}i="",(r=t.indexOf(e+"BEGIN_BLOB"))>-1&&(i=t.substr(r+(e+"BEGIN_BLOB").length,t.indexOf(e+"END_BLOB")-(r+(e+"BEGIN_BLOB").length)));try{i.length>0&&(this._data_blob=i,this.storageBytesBlob=i.length,this.isNewStorage=!1)}catch(t){}},k.WindowStorage.prototype.commit=function(){var t=window.name;e.isDefined(t)||(t="");var i=this.guid+"_",r=t.indexOf(i+"BEGIN_OBJ"),n=JSON.stringify(this._data_obj),a=i+"BEGIN_OBJ"+n+i+"END_OBJ";r>-1?t=t.substr(0,r)+a+t.substr(t.indexOf(i+"END_OBJ")+(i+"END_OBJ").length):t+=a,r=t.indexOf(i+"BEGIN_BLOB"),a=i+"BEGIN_BLOB"+this._data_blob+i+"END_BLOB",r>-1?t=t.substr(0,r)+a+t.substr(t.indexOf(i+"END_BLOB")+(i+"END_BLOB").length):t+=a,window.name=k.nameBackup=t,this.storageBytes=window.name.length},k.nameBackup=window.name,k});